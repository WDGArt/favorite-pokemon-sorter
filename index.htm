<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ultimate Favorite Pok√©mon Sorter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    .volume-control {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 0.8rem;
        color: #9ca3af;
    }

    .volume-control input[type="range"] {
        width: 90px;
    }

  
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      padding: 12px;
    }

    .app {
      max-width: 900px;
      width: 100%;
      background: radial-gradient(circle at top, #111827, #020617 55%);
      border-radius: 18px;
      padding: 16px;
      border: 1px solid #1f2937;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.7);
    }

    header {
      text-align: center;
      margin-bottom: 10px;
    }

    h1 {
      margin: 0;
      font-size: 1.6rem;
      color: #facc15;
    }

    .subtitle {
      margin: 4px 0 0;
      font-size: 0.9rem;
      color: #9ca3af;
    }

    .status-bar {
      margin: 8px 0;
      font-size: 0.85rem;
      color: #9ca3af;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-start;
      align-items: center;
    }

    
    .status-controls {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: nowrap;
    }
.status-bar span {
      white-space: nowrap;
    }

    button {
      cursor: pointer;
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 0.9rem;
      font-weight: 600;
      background: #2563eb;
      color: white;
      transition: transform 0.05s ease, box-shadow 0.05s ease, background 0.1s ease;
      white-space: nowrap;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
    }

    button.secondary {
      background: #374151;
    }

    button:disabled {
      opacity: 0.6;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .main-layout {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    @media (min-width: 768px) {
      .main-layout {
        flex-direction: row;
      }
    }

    .compare-area {
      flex: 2;
      border-radius: 16px;
      border: 1px solid #1f2937;
      padding: 10px;
      background: linear-gradient(145deg, #020617, #030712);
    }

    .compare-title {
      text-align: center;
      margin: 0 0 8px;
      font-size: 1.05rem;
    }

    .cards-row {
      display: flex;
      gap: 8px;
      justify-content: center;
      align-items: stretch;
      flex-wrap: wrap;
    }

    
    .poke-card {
      flex: 1 1 160px;
      max-width: 230px;
      background: #020617;
      border-radius: 16px;
      border: 1px solid #1f2937;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.6);
      position: relative;
    }

    .poke-name {
      font-weight: 600;
      font-size: 1rem;
      margin-bottom: 2px;
      text-transform: capitalize;
    }

    .poke-id {
      font-size: 0.75rem;
      color: #9ca3af;
      margin-bottom: 4px;
    }


    .bulba-link {
      position: absolute;
      top: 8px;
      right: 10px;
      font-size: 0.75rem;
      opacity: 0;
      transition: opacity 120ms ease-in-out;
      pointer-events: none; /* avoid affecting clicks until visible */
    }
    .poke-card:hover .bulba-link {
      opacity: 1;
      pointer-events: auto;
    }
    .bulba-link a {
      color: #93c5fd;
      text-decoration: none;
      background: rgba(2, 6, 23, 0.75);
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 2px 6px;
      border-radius: 999px;
    }
    .bulba-link a:hover {
      text-decoration: underline;
    }

    .image-wrap {
      width: 112px;
      height: 112px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 6px;
    }

    /* Selection Pok√© Ball behind the sprite */
    .selection-ball {
      width: 112px;
      height: 112px;
      border-radius: 50%;
      position: relative;
      background: linear-gradient(
        to bottom,
        #ef4444 0%,
        #ef4444 48%,
        #111827 48%,
        #111827 52%,
        #f9fafb 52%,
        #f9fafb 100%
      );
      border: 2px solid #111827;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .selection-center {
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f9fafb;
      border: 2px solid #111827;
      box-shadow: 0 0 0 2px rgba(17, 24, 39, 0.7);
    }

    /* Smooth bounce animation */
    @keyframes poke-bounce-hover {
      0%   { transform: translateY(0); }
      25%  { transform: translateY(-8px); }
      50%  { transform: translateY(-2px); }
      75%  { transform: translateY(-6px); }
      100% { transform: translateY(0); }
    }


    /* Trigger bounce when hovering the card */
    .poke-card:hover img {
      animation: poke-bounce-hover 0.9s ease-in-out infinite;
    }

    /* Sprite inside the selection ball */
    .selection-ball img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      image-rendering: pixelated;
      position: relative;
      z-index: 1;
    }

    .image-wrap img {
      width: 96px;
      height: 96px;
      object-fit: contain;
      image-rendering: pixelated;
    }

    .placeholder {
      font-size: 0.75rem;
      color: #6b7280;
    }

    .choose-btn {
      margin-top: 6px;
      width: 100%;
      font-size: 0.9rem;
      background: #16a34a;
    }

    .choose-btn.right {
      background: #ec4899;
    }

    .vs-tag {
      font-weight: 700;
      font-size: 0.85rem;
      color: #9ca3af;
      text-align: center;
      margin: 4px 0;
    }

    .compare-footer {
      margin-top: 6px;
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .side-panel {
      flex: 1;
      border-radius: 16px;
      border: 1px solid #1f2937;
      padding: 10px;
      background: #020617;
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 420px;
    }

    .side-panel h2 {
      margin: 0;
      font-size: 1rem;
    }

    .small-text {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .ranking-list {
      flex: 1;
      border-radius: 12px;
      border: 1px solid #111827;
      background: #030712;
      padding: 6px 8px;
      overflow-y: auto;
      font-size: 0.85rem;
    }

    .ranking-list ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .ranking-list li {
      padding: 2px 0;
      border-bottom: 1px solid #020617;
      display: flex;
      justify-content: flex-start;
      gap: 6px;
    }

    .ranking-list li:last-child {
      border-bottom: none;
    }

    .rank-num {
      color: #9ca3af;
      min-width: 32px;
    }

    .rank-name {
      flex: 1;
      text-transform: capitalize;
    }

    .rank-id {
      color: #6b7280;
      font-size: 0.75rem;
    }

    .favorite-line {
      font-size: 0.9rem;
      font-weight: 600;
      color: #fbbf24;
    }

    .log-box {
      display: none;
    }

    .log-box p {
      margin: 0 0 2px;
    }

    .log-box p:last-child {
      margin-bottom: 0;
    }

    /* Full ranking Pok√© Ball grid */

    .full-ranking-section {
      margin-top: 16px;
      border-radius: 16px;
      border: 1px solid #1f2937;
      background: #020617;
      padding: 10px 12px;
    }

    .full-ranking-title {
      margin: 0 0 4px;
      font-size: 1rem;
    }

    .secondary-grid-title {
      margin-top: 12px;
    }


    .full-ranking-grid {
      margin-top: 6px;
      border-radius: 12px;
      border: 1px solid #111827;
      background: #030712;
      padding: 8px 6px;
      display: grid;
      /* bigger slots so you can see it better */
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 10px;
      max-height: 320px;
      overflow-y: auto;
    }

    .full-ranking-empty {
      font-size: 0.85rem;
      color: #9ca3af;
      padding: 4px 6px;
      grid-column: 1 / -1;
      white-space: nowrap;
    }

    .ball-tile {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0.8rem;
      color: #e5e7eb;
    }

    .ball-shell {
      width: 110px;   /* larger for visibility */
      height: 110px;
      border-radius: 50%;
      position: relative;
      background: linear-gradient(to bottom,
        #ef4444 0%,
        #ef4444 48%,
        #111827 48%,
        #111827 52%,
        #f9fafb 52%,
        #f9fafb 100%);
      border: 2px solid #111827;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .ball-shell.mega-ring,
    .selection-ball.mega-ring {
      box-shadow: 0 0 0 4px #3b82f6, 0 3px 8px rgba(0, 0, 0, 0.85);
    }

    .ball-shell.gmax-ring,
    .selection-ball.gmax-ring {
      box-shadow: 0 0 0 4px #ef4444, 0 3px 8px rgba(0, 0, 0, 0.85);
    }

    .ball-shell.regional-ring,
    .selection-ball.regional-ring {
      box-shadow: 0 0 0 4px #a855f7, 0 3px 8px rgba(0, 0, 0, 0.85);
    }

    .ball-shell.variant-ring,
    .selection-ball.variant-ring {
      box-shadow: 0 0 0 4px #ec4899, 0 3px 8px rgba(0, 0, 0, 0.85);
    }

    .ball-shell.special-ring,
    .selection-ball.special-ring {
      box-shadow: 0 0 0 4px #22c55e, 0 3px 8px rgba(0, 0, 0, 0.85);
    }


    .ball-center {
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f9fafb;
      border: 2px solid #111827;
      box-shadow: 0 0 0 2px rgba(17, 24, 39, 0.7);
    }

    .ball-sprite {
      position: relative;
      width: 80px;
      height: 80px;
      image-rendering: pixelated;
      object-fit: contain;
    }

    .ball-rank {
      margin-top: 4px;
    }

    .curated-dex {
      margin-top: 2px;
      font-size: 0.75rem;
      color: #9ca3af;
      letter-spacing: 0.02em;
    }

    /* Form badges bottom-right (image-based, with fallback text) */

    .form-badge {
        position: absolute;
        bottom: 3px;
        right: 3px;
        width: 28px;
        height: 28px;
        z-index: 10;
        background: #020617;
        border-radius: 50%;
        border: 1px solid #111827;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 4px rgba(0,0,0,0.8);
        overflow: hidden;
        pointer-events: none;
    }


    .form-badge-icon {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .form-badge.mega-badge {
      background: radial-gradient(circle at 30% 30%, #bfdbfe, #1d4ed8);
    }

    .form-badge.gmax-badge {
      background: radial-gradient(circle at 30% 30%, #fecaca, #b91c1c);
    }
    
    .form-badge.regional-badge {
        background: radial-gradient(circle at 30% 30%, #e5d9ff, #6d28d9);
    }
</style>
</head>
<body>
  <div class="app">
    <audio id="bgm" src="https://files.catbox.moe/f4d7kn.mp3" loop></audio>
    <header>
      <h1>Ultimate Favorite Pok√©mon Sorter</h1>
      <p class="subtitle">
        Welcome to the Ultimate Favorite Pok√©mon Sorter, where you will rank pokemon in head to head comparisons to find which one is your favorite.
      </p>
    </header>

    <div class="status-bar">
      <div class="status-controls">

        <div class="volume-control">
            <label for="volume-slider">üîä</label>
            <input
                type="range"
                id="volume-slider"
                min="0"
                max="100"
                value="25"
            />
        </div>

        <button id="music-btn" class="secondary" disabled>Music: Off</button>
        <button id="start-btn" disabled>Start!</button>
      </div>
    </div>



    <div class="main-layout">
      <section class="compare-area">
        <h2 class="compare-title" id="compare-title">Waiting to start‚Ä¶</h2>

        <div class="cards-row">
          <div class="poke-card" id="card-left">
            <div class="poke-name" id="name-left">‚Äî</div>
            <div class="poke-id" id="id-left"></div>
                        <div class="bulba-link"><a id="bulba-left" href="#" target="_blank" rel="noopener noreferrer">Bulbapedia</a></div>
<div class="image-wrap">
              <div class="selection-ball">
                    <div class="selection-center"></div>
                        <img id="img-left" alt="" style="display:none;">
                    </div>
                <div class="placeholder" id="img-placeholder-left">No image</div>
            </div>

            <button class="choose-btn" id="btn-left" disabled>I prefer this one</button>
          </div>

          <div>
            <div class="vs-tag">VS</div>
          </div>

          <div class="poke-card" id="card-right">
            <div class="poke-name" id="name-right">‚Äî</div>
            <div class="poke-id" id="id-right"></div>
                        <div class="bulba-link"><a id="bulba-right" href="#" target="_blank" rel="noopener noreferrer">Bulbapedia</a></div>
<div class="image-wrap">
              <div class="selection-ball">
                <div class="selection-center"></div>
                    <img id="img-right" alt="" style="display:none;">
                </div>
              <div class="placeholder" id="img-placeholder-right">No image</div>
            </div>

            <button class="choose-btn right" id="btn-right" disabled>I prefer this one</button>
          </div>
        </div>

        <div class="compare-footer">
          <button id="undo-btn" class="secondary" disabled>Undo</button>
          <button id="tie-btn" class="secondary" disabled>Tie</button>
          <button id="reset-btn" class="secondary" disabled>Reset &amp; start over</button>
        </div>
      </section>

      <aside class="side-panel">
        <div>
          <h2>Current Ranking (Top 15)</h2>
          <p class="small-text">
            The list below updates as you go. #1 is your current favorite.
          </p>
        </div>
        <div class="ranking-list" id="ranking-list">
          <ul id="ranking-ul">
            <li><span class="rank-num">‚Äì</span><span class="rank-name">No Pok√©mon ranked yet.</span></li>
          </ul>
        </div>
        <div class="favorite-line" id="favorite-line"></div>
        <div class="log-box" id="log-box">
          <p>Log will appear here as you make choices.</p>
        </div>
      </aside>
    </div>

    <!-- Full ranking grid: Pok√© Balls with type-colored shells & form rings/badges -->
    <section class="full-ranking-section">
      <h2 class="full-ranking-title">Full Ranking Grid</h2>
      <p class="small-text">
        Each Pok√© Ball shows a ranked Pok√©mon. Top is its primary type color, bottom is its secondary (or primary again).
        Blue ring = Mega, Red ring = G-Max, Purple ring = Regional, Pink = Variant, and Green = Special. Megas & G-Maxes
        also have a small symbol at bottom-right, while Regional Variants have a symbol for which region is in question.
        Clover = Alola, Stadium Symbol = Galar, Arceus' Ring = Hisui, and Tera Gem = Paldea.
      </p>
      <div class="full-ranking-grid" id="full-ranking-grid">
        <div class="full-ranking-empty">No Pok√©mon ranked yet.</div>
      </div>
</section>
  </div>

  <script>
    // --- CONFIG ---
	const HOME_SPRITE_BASE = "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/render/";
    const volumeSlider = document.getElementById("volume-slider");
    const VOLUME_KEY = "favoritePokemonSorter_volume";

    const bgm = document.getElementById("bgm");
    const musicBtn = document.getElementById("music-btn");
    let musicEnabled = false;

    let singleUnownMode = false;
    let singleCastformMode = false;
    let singleDeoxysMode = false;
    let singleBurmyMode = false;
    let singleWormadamMode = false;
    let singleRotomMode = false;
    let singleArceusMode = false;
    let singleDeerlingSawsbuckMode = false;
    let singleGenesectMode = false;
    let singleVivillonMode = false;
    let singleFlabebeFloetteFlorgesMode = false;
    let singleFurfrouMode = false;
    let singlePumpkabooGourgeistMode = false;
    let singleLycanrocMode = false;
    let singleSilvallyMode = false;
    let singleMiniorMode = false;
    let singleAlcremieMode = false;
    let singleSquawkabillyMode = false;
    let megasIncludedMode = true;
    let gMaxsIncludedMode = true;

    // Put YOUR icon URLs here (leave "" to just show text M / Gx)
    const MEGA_ICON_URL = "https://archives.bulbagarden.net/media/upload/b/bb/Tretta_Mega_Evolution_icon.png";
    const GMAX_ICON_URL = "https://archives.bulbagarden.net/media/upload/9/9f/Dynamax_icon.png";
    const ALOLA_ICON_URL  = "https://archives.bulbagarden.net/media/upload/c/c3/Black_clover_VIII.png";
    const GALAR_ICON_URL  = "https://archives.bulbagarden.net/media/upload/3/3e/Galar_symbol.png";
    const HISUI_ICON_URL  = "https://archives.bulbagarden.net/media/upload/d/dc/Arceus_mark.png";
    const PALDEA_ICON_URL = "https://archives.bulbagarden.net/media/upload/8/89/Paldea_icon.png";


    const MAX_SPECIES_DEX_ID = 1025;

    // Extra forms with formKind: "mega", "gmax", or "regional"
    const EXTRA_FORMS_CONFIG = {
      3: [
        { pokemonName: "venusaur-mega", label: "Mega Venusaur", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/3-mega.png" },
        { pokemonName: "venusaur-gmax", label: "G-Max Venusaur", formKind: "gmax" }
      ],
      6: [
        { pokemonName: "charizard-mega-x", label: "Mega Charizard X", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/6-mega-x.png" },
        { pokemonName: "charizard-mega-y", label: "Mega Charizard Y", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/6-mega-y.png" },
        { pokemonName: "charizard-gmax", label: "G-Max Charizard", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/6-gmax.png" }
      ],
      9: [
        { pokemonName: "blastoise-mega", label: "Mega Blastoise", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/9-mega.png" },
        { pokemonName: "blastoise-gmax", label: "G-Max Blastoise", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/9-gmax.png"}
      ],
      12: [
        { pokemonName: "butterfree-gmax", label: "G-Max Butterfree", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/12-gmax.png" }
      ],
      15: [
        { pokemonName: "beedrill-mega", label: "Mega Beedrill", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/15-mega.png" }    
      ],
      18: [
        { pokemonName: "pidgeot-mega", label: "Mega Pidgeot", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/18-mega.png" }    
      ],
      19: [
        { pokemonName: "rattata-alola", label: "Alolan Rattata", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/19-regional-a.png" } 
      ],
      20: [
        { pokemonName: "raticate-alola", label: "Alolan Raticate", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/20-regional-a.png" }    
      ],
      25: [
        { pokemonName: "pikachu-gmax", label: "G-Max Pikachu", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/25-gmax.png" }
      ],
      26: [
        { pokemonName: "raichu-alola", label: "Alolan Raichu", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/26-regional-a.png" },
        { pokemonName: "raichu-mega-x", label: "Mega Raichu X", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/026-mx.png" },
        { pokemonName: "raichu-mega-y", label: "Mega Raichu Y", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/026-my.png" }
      ],
      27: [
        { pokemonName: "sandshrew-alola", label: "Alolan Sandshrew", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/27-regional-a.png" }    
      ],
      28: [
        { pokemonName: "sandslash-alola", label: "Alolan Sandslash", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/28-regional-a.png" }    
      ],
      36: [
        { pokemonName: "clefable-mega", label: "Mega Clefable", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/36-mega.png" }    
      ],
      37: [
        { pokemonName: "vulpix-alola", label: "Alolan Vulpix", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/37-regional-a.png" }   
      ],
      38: [
        { pokemonName: "ninetales-alola", label: "Alolan Ninetales", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/38-regional-a.png" }    
      ],
      50: [
        { pokemonName: "diglett-alola", label: "Alolan Diglett", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/50-regional-a.png" } 
      ],
      51: [
        { pokemonName: "dugtrio-alola", label: "Alolan Dugtrio", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/51-regional-a.png" } 
      ],
      52: [
        { pokemonName: "meowth-alola", label: "Alolan Meowth", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/52-regional-a.png" } ,
        { pokemonName: "meowth-galar", label: "Galarian Meowth", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/52-regional-g.png" } ,
        { pokemonName: "meowth-gmax", label: "G-Max Meowth", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/52-gmax.png" }
      ],
      53: [
        { pokemonName: "persian-alola", label: "Alolan Persian", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/53-regional-a.png" } 
      ],
      58: [
        { pokemonName: "growlithe-hisui", label: "Hisuian Growlithe", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/58-regional-h.png" } 
      ],
      59: [
        { pokemonName: "arcanine-hisui", label: "Hisuian Arcanine", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/59-regional-h.png" } 
      ],
      65: [
        { pokemonName: "alakazam-mega", label: "Mega Alakazam", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/65-mega.png" } 
      ],
      68: [
        { pokemonName: "machamp-gmax", label: "G-Max Machamp", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/68-gmax.png" } 
      ],
      71: [
        { pokemonName: "victreebel-mega", label: "Mega Victreebel", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/71-mega.png" } 
      ],
      74: [
        { pokemonName: "geodude-alola", label: "Alolan Geodude", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/74-regional-a.png" } 
      ],
      75: [
        { pokemonName: "graveler-alola", label: "Alolan Graveler", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/75-regional-a.png" } 
      ],
      76: [
        { pokemonName: "golem-alola", label: "Alolan Golem", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/76-regional-a.png" } 
      ],
      77: [
        { pokemonName: "ponyta-galar", label: "Galarian Ponyta", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/77-regional-g.png" } 
      ],
      78: [
        { pokemonName: "rapidash-galar", label: "Galarian Rapidash", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/78-regional-g.png" } 
      ],
      79: [
        { pokemonName: "slowpoke-galar", label: "Galarian Slowpoke", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/79-regional-g.png" } 
      ],
      80: [
        { pokemonName: "slowbro-mega", label: "Mega Slowbro", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/80-mega.png" } ,
        { pokemonName: "slowbro-galar", label: "Galarian Slowbro", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/80-regional-g.png" }
      ],
      83: [
        { pokemonName: "farfetchd-galar", label: "Galarian Farfetch'd", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/83-regional-g.png" } 
      ],
      88: [
        { pokemonName: "grimer-alola", label: "Alolan Grimer", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/88-regional-a.png" } 
      ],
      89: [
        { pokemonName: "muk-alola", label: "Alolan Muk", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/89-regional-a.png" } 
      ],
      94: [
        { pokemonName: "gengar-mega", label: "Mega Gengar", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/94-mega.png" },
        { pokemonName: "gengar-gmax", label: "G-Max Gengar", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/94-gmax.png" } 
      ],
      99: [
        { pokemonName: "kingler-gmax", label: "G-Max Kingler", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/99-gmax.png" } 
      ],
      100: [
        { pokemonName: "voltorb-hisui", label: "Hisuian Voltorb", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/100-regional-h.png" } 
      ],
      101: [
        { pokemonName: "electrode-hisui", label: "Hisuian Electrode", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/101-regional-h.png" } 
      ],
      103: [
        { pokemonName: "exeggutor-alola", label: "Alolan Exeggutor", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/103-regional-a.png" } 
      ],
      105: [
        { pokemonName: "marowak-alola", label: "Alolan Marowak", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/105-regional-a.png" } 
      ],
      110: [
        { pokemonName: "weezing-galar", label: "Galarian Weezing", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/110-regional-g.png" } 
      ],
      115: [
        { pokemonName: "kangaskhan-mega", label: "Mega Kangaskhan", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/115-mega.png" } 
      ],
      121: [
        { pokemonName: "starmie-mega", label: "Mega Starmie", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/121-mega.png" } 
      ],
      122: [
        { pokemonName: "mr-mime-galar", label: "Galarian Mr. Mine", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/122-regional-g.png" } 
      ],
      127: [
        { pokemonName: "pinsir-mega", label: "Mega Pinsir", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/127-mega.png" } 
      ],
      128: [
        { pokemonName: "tauros-paldea-combat-breed", label: "Combat Breed Tauros", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/128-regional-p-combat.png" } ,
        { pokemonName: "tauros-paldea-blaze-breed", label: "Blaze Breed Tauros", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/128-regional-p-blaze.png" } ,
        { pokemonName: "tauros-paldea-aqua-breed", label: "Aqua Breed Tauros", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/128-regional-p-aqua.png" } 
      ],
      130: [
        { pokemonName: "gyarados-mega", label: "Mega Gyarados", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/130-mega.png" } 
      ],
      131: [
        { pokemonName: "lapras-gmax", label: "G-Max Lapras", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/131-gmax.png" } 
      ],
      133: [
        { pokemonName: "eevee-gmax", label: "G-Max Eevee", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/133-gmax.png" }
      ],
      142: [
        { pokemonName: "aerodactyl-mega", label: "Mega Aerodactyl", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/142-mega.png" } 
      ],
      143: [
        { pokemonName: "snorlax-gmax", label: "G-Max Snorlax", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/143-gmax.png" } 
      ],
      144: [
        { pokemonName: "articuno-galar", label: "Galarian Articuno", formKind: "regional" , spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/144-regional-g.png"} 
      ],
      145: [
        { pokemonName: "zapdos-galar", label: "Galarian Zapdos", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/145-regional-g.png" } 
      ],
      146: [
        { pokemonName: "moltres-galar", label: "Galarian Moltres", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/146-regional-g.png" } 
      ],
      149: [
        { pokemonName: "Dragonite-mega", label: "Mega Dragonite", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/149-mega.png" } 
      ],
      150: [
        { pokemonName: "mewtwo-shadow", label: "Shadow Mewtwo", primaryTypeOverride: "psychic", formKind: "special", spriteOverride: "https://archives.bulbagarden.net/media/upload/thumb/7/7a/Pokk%C3%A9n_Shadow_Mewtwo.png/184px-Pokk%C3%A9n_Shadow_Mewtwo.png" },
        { pokemonName: "mewtwo-mega-x", label: "Mega Mewtwo X", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/150-mega-x.png" } ,
        { pokemonName: "mewtwo-shadow-mega-x", label: "Shadow Mega Mewtwo X", primaryTypeOverride: "psychic", secondaryTypeOverride: "fighting", formKind: "mega", spriteOverride: "https://archives.bulbagarden.net/media/upload/thumb/6/68/Pokk%C3%A9n_Mega_Shadow_Mewtwo_X.png/83px-Pokk%C3%A9n_Mega_Shadow_Mewtwo_X.png" },
        { pokemonName: "mewtwo-mega-y", label: "Mega Mewtwo Y", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/150-mega-y.png" }
      ],
      154: [
        { pokemonName: "meganium-mega", label: "Mega Meganium", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/154-mega.png" } 
      ],
      157: [
        { pokemonName: "typhlosion-hisui", label: "Hisuian Typhlosion", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/157-regional-h.png" } 
      ],
      160: [
        { pokemonName: "feraligatr-mega", label: "Mega Feraligatr", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/160-mega.png" } 
      ],
      181: [
        { pokemonName: "ampharos-mega", label: "Mega Ampharos", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/181-mega.png" } 
      ],
      194: [
        { pokemonName: "wooper-paldea", label: "Paldean Wooper", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/194-regional-p.png" } 
      ],
      199: [
        { pokemonName: "slowking-galar", label: "Galarian Slowking", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/199-regional-g.png" } 
      ],
      201: [
        { pokemonName: "unown", label: "Unown (B)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-b.png" } ,
        { pokemonName: "unown", label: "Unown (C)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-c.png" } ,
        { pokemonName: "unown", label: "Unown (D)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-d.png" } ,
        { pokemonName: "unown", label: "Unown (E)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-e.png" } ,
        { pokemonName: "unown", label: "Unown (F)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-f.png" } ,
        { pokemonName: "unown", label: "Unown (G)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-g.png" } ,
        { pokemonName: "unown", label: "Unown (H)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-h.png" } ,
        { pokemonName: "unown", label: "Unown (I)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-i.png" } ,
        { pokemonName: "unown", label: "Unown (J)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-j.png" } ,
        { pokemonName: "unown", label: "Unown (K)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-k.png" } ,
        { pokemonName: "unown", label: "Unown (L)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-l.png" } ,
        { pokemonName: "unown", label: "Unown (M)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-m.png" } ,
        { pokemonName: "unown", label: "Unown (N)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-n.png" } ,
        { pokemonName: "unown", label: "Unown (O)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-o.png" } ,
        { pokemonName: "unown", label: "Unown (P)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-p.png" } ,
        { pokemonName: "unown", label: "Unown (Q)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-q.png" } ,
        { pokemonName: "unown", label: "Unown (R)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-r.png" } ,
        { pokemonName: "unown", label: "Unown (S)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-s.png" } ,
        { pokemonName: "unown", label: "Unown (T)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-t.png" } ,
        { pokemonName: "unown", label: "Unown (U)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-u.png" } ,
        { pokemonName: "unown", label: "Unown (V)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-v.png" } ,
        { pokemonName: "unown", label: "Unown (W)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-w.png" } ,
        { pokemonName: "unown", label: "Unown (X)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-x.png" } ,
        { pokemonName: "unown", label: "Unown (Y)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-y.png" } ,
        { pokemonName: "unown", label: "Unown (Z)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-z.png" } ,
        { pokemonName: "unown", label: "Unown (!)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-exclamation.png" } ,
        { pokemonName: "unown", label: "Unown (?)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-question.png" } ,
      ],
      208: [
        { pokemonName: "steelix-mega", label: "Mega Steelix", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/208-mega.png" } 
      ],
      211: [
        { pokemonName: "qwilfish-hisui", label: "Hisuian Qwilfish", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/211-regional-h.png" } 
      ],
      212: [
        { pokemonName: "scizor-mega", label: "Mega Scizor", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/212-mega.png" } 
      ],
      214: [
        { pokemonName: "heracross-mega", label: "Mega Heracross", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/214-mega.png" } 
      ],
      215: [
        { pokemonName: "sneasel-hisui", label: "Hisuian Sneasel", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/215-regional-h.png" } 
      ],
      222: [
        { pokemonName: "corsola-galar", label: "Galarian Corsola", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/222-regional-g.png" } 
      ],
      227: [
        { pokemonName: "skarmory-mega", label: "Mega Skarmory", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/227-mega.png" } 
      ],
      229: [
        { pokemonName: "houndoom-mega", label: "Mega Houndoom", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/229-mega.png" } 
      ],
      248: [
        { pokemonName: "tyranitar-mega", label: "Mega Tyranitar", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/248-mega.png" } 
      ],
      249: [
        { pokemonName: "lugia-shadow", label: "Shadow Lugia", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/forgotten-dex/pokemon/249-xd-shadow-aura.png", primaryTypeOverride: "psychic", secondaryTypeOverride: "flying" } 
      ],
      254: [
        { pokemonName: "sceptile-mega", label: "Mega Sceptile", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/254-mega.png" }
      ],
      257: [
        { pokemonName: "blaziken-mega", label: "Mega Blaziken", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/257-mega.png" }
      ],
      260: [
        { pokemonName: "swampert-mega", label: "Mega Swampert", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/260-mega.png" }
      ],
      263: [
        { pokemonName: "zigzagoon-galar", label: "Galarian Zigzagoon", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/263-regional-g.png" }
      ],
      264: [
        { pokemonName: "linoone-galar", label: "Galarian Linoone", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/264-regional-g.png" }
      ],
      282: [
        { pokemonName: "gardevoir-mega", label: "Mega Gardevoir", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/282-mega.png" }
      ],
      302: [
        { pokemonName: "sableye-mega", label: "Mega Sableye", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/302-mega.png" }
      ],
      303: [
        { pokemonName: "mawile-mega", label: "Mega Mawile", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/303-mega.png" }
      ],
      306: [
        { pokemonName: "aggron-mega", label: "Mega Aggron", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/306-mega.png" }
      ],
      308: [
        { pokemonName: "medicham-mega", label: "Mega Medicham", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/308-mega.png" }
      ],
      310: [
        { pokemonName: "manectric-mega", label: "Mega Manectric", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/310-mega.png" }
      ],
      319: [
        { pokemonName: "sharpedo-mega", label: "Mega Sharpedo", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/319-mega.png" }
      ],
      323: [
        { pokemonName: "camerupt-mega", label: "Mega Camerupt", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/323-mega.png" }
      ],
      334: [
        { pokemonName: "altaria-mega", label: "Mega Altaria", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/334-mega.png" }
      ],
      351: [
        { pokemonName: "castform-sunny", label: "Sunny Castform", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/351-sunny.png" },
        { pokemonName: "castform-rainy", label: "Rainy Castform", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/351-rainy.png" },
        { pokemonName: "castform-snowy", label: "Snowy Castform", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/351-snowy.png" }
      ],
      354: [
        { pokemonName: "banette-mega", label: "Mega Banette", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/354-mega.png" }
      ],
      358: [
        { pokemonName: "chimecho-mega", label: "Mega Chimecho", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/358-m.png" }
      ],
      359: [
        { pokemonName: "absol-mega", label: "Mega Absol", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/359-mega.png" },
        { pokemonName: "absol-mega-z", label: "Mega Absol Z", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/359-mz.png" }
      ],
      362: [
        { pokemonName: "glalie-mega", label: "Mega Glalie", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/362-mega.png" }
      ],
      373: [
        { pokemonName: "salamence-mega", label: "Mega Salamence", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/373-mega.png" }
      ],
      376: [
        { pokemonName: "metagross-mega", label: "Mega Metagross", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/376-mega.png" }
      ],
      380: [
        { pokemonName: "latias-mega", label: "Mega Latias", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/380-mega.png" }
      ],
      381: [
        { pokemonName: "latios-mega", label: "Mega Latios", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/381-mega.png" }
      ],
      382: [
        { pokemonName: "kyogre-primal", label: "Primal Kyogre", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/382-mega.png" }
      ],
      383: [
        { pokemonName: "groudon-primal", label: "Primal Groudon", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/383-mega.png" }
      ],
      384: [
        { pokemonName: "rayquaza-mega", label: "Mega Rayquaza", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/384-mega.png" }
      ],
      386: [
        { pokemonName: "deoxys-attack", label: "Deoxys (Attack Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/386-attack.png", nameOverride: "Deoxys" },
        { pokemonName: "deoxys-defense", label: "Deoxys (Defense Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/386-defense.png", nameOverride: "Deoxys" },
        { pokemonName: "deoxys-speed", label: "Deoxys (Speed Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/386-speed.png", nameOverride: "Deoxys" }
      ],
      398: [
        { pokemonName: "staraptor-mega", label: "Mega Staraptor", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/398-m.png" }
      ],
      412: [
        { pokemonName: "burmy", label: "Burmy (Sandy Cloak)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/412-sandy.png" },
        { pokemonName: "burmy", label: "Burmy (Trash Cloak)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/412-trash.png" }
      ],
      413: [
        { pokemonName: "wormadam-sandy", label: "Wormadam (Sandy Cloak)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/413-sandy.png" },
        { pokemonName: "wormadam-trash", label: "Wormadam (Trash Cloak)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/413-trash.png" }
      ],
      422: [
        { pokemonName: "shellos", label: "Shellos (East Sea)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/422-east.png" }
      ],
      423: [
        { pokemonName: "gastrodon", label: "Gastrodon (East Sea)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/423-east.png" }
      ],
      428: [
        { pokemonName: "lopunny-mega", label: "Mega Lopunny", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/428-mega.png" }
      ],
      445: [
        { pokemonName: "garchomp-mega", label: "Mega Garchomp", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/445-mega.png" },
        { pokemonName: "garchomp-mega-z", label: "Mega Garchomp Z", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/445-mega-z.png" }
      ],
      448: [
        { pokemonName: "lucario-mega", label: "Mega Lucario", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/448-mega.png" },
        { pokemonName: "lucario-mega-z", label: "Mega Lucario Z", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/448-mz.png" }
      ],
      460: [
        { pokemonName: "abomasnow-mega", label: "Mega Abomasnow", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/460-mega.png" }
      ],
      475: [
        { pokemonName: "gallade-mega", label: "Mega Gallade", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/475-mega.png" }
      ],
      478: [
        { pokemonName: "froslass-mega", label: "Mega Froslass", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/478-mega.png" }
      ],
      479: [
        { pokemonName: "rotom-heat", label: "Rotom (Heat)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/479-heat.png" },
        { pokemonName: "rotom-wash", label: "Rotom (Wash)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/479-wash.png" },
        { pokemonName: "rotom-frost", label: "Rotom (Frost)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/479-frost.png" },
        { pokemonName: "rotom-fan", label: "Rotom (Fan)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/479-fan.png" },
        { pokemonName: "rotom-mow", label: "Rotom (Mow)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/479-mow.png" }
      ],
      483: [
        { pokemonName: "dialga-origin", label: "Dialga (Origin Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/483-origin.png" }
      ],
      484: [
        { pokemonName: "palkia-origin", label: "Palkia (Origin Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/484-origin.png" }
      ],
      485: [
        { pokemonName: "heatran-mega", label: "Meag Heatran", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/485-m.png" }
      ],
      487: [
        { pokemonName: "giratina-origin", label: "Giratina (Origin Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/487-origin.png" }
      ],
      491: [
        { pokemonName: "darkrai-mega", label: "Mega Darkrai", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/491-m.png" }
      ],
      492: [
        { pokemonName: "shaymin-sky", label: "Shaymin (Sky Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/492-sky.png" }
      ],
      493: [
        { pokemonName: "acreus", label: "Arceus (Bug Type)", primaryTypeOverride: "bug", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-bug.png" },
        { pokemonName: "acreus", label: "Arceus (Dark Type)", primaryTypeOverride: "dark", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-dark.png" },
        { pokemonName: "acreus", label: "Arceus (Dragon Type)", primaryTypeOverride: "dragon", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-dragon.png" },
        { pokemonName: "acreus", label: "Arceus (Electric Type)", primaryTypeOverride: "electric", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-electric.png" },
        { pokemonName: "acreus", label: "Arceus (Fighting Type)", primaryTypeOverride: "fighting", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-fighting.png" },
        { pokemonName: "acreus", label: "Arceus (Fire Type)", primaryTypeOverride: "fire", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-fire.png" },
        { pokemonName: "acreus", label: "Arceus (Flying Type)", primaryTypeOverride: "flying", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-flying.png" },
        { pokemonName: "acreus", label: "Arceus (Ghost Type)", primaryTypeOverride: "ghost", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-ghost.png" },
        { pokemonName: "acreus", label: "Arceus (Grass Type)", primaryTypeOverride: "grass", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-grass.png" },
        { pokemonName: "acreus", label: "Arceus (Ground Type)", primaryTypeOverride: "ground", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-ground.png" },
        { pokemonName: "acreus", label: "Arceus (Ice Type)", primaryTypeOverride: "ice", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-ice.png" },
        { pokemonName: "acreus", label: "Arceus (Poison Type)", primaryTypeOverride: "poison", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-poison.png" },
        { pokemonName: "acreus", label: "Arceus (Psychic Type)", primaryTypeOverride: "psychic", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-psychic.png" },
        { pokemonName: "acreus", label: "Arceus (Rock Type)", primaryTypeOverride: "rock", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-rock.png" },
        { pokemonName: "acreus", label: "Arceus (Steel Type)", primaryTypeOverride: "steel", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-steel.png" },
        { pokemonName: "acreus", label: "Arceus (Water Type)", primaryTypeOverride: "water", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-water.png" },
        { pokemonName: "acreus", label: "Arceus (Fairy Type)", primaryTypeOverride: "fairy", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/493-fairy.png" }
      ],
      500: [
        { pokemonName: "emboar-mega", label: "Mega Emboar", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/500-mega.png" }
      ],
      503: [
        { pokemonName: "samurott-hisui", label: "Hisuian Samurott", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/503-regional-h.png" }
      ],
      530: [
        { pokemonName: "excadrill-mega", label: "Mega Excadrill", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/530-mega.png" }
      ],
      531: [
        { pokemonName: "audino-mega", label: "Mega Audino", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/531-mega.png" }
      ],
      545: [
        { pokemonName: "scolipede-mega", label: "Mega Scolipede", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/545-mega.png" }
      ],
      549: [
        { pokemonName: "lilligant-hisui", label: "Hisuian Lilligant", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/549-regional-h.png" }
      ],
      550: [
        { pokemonName: "basculin-blue-striped", label: "Blue Striped Basculin", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/550-blue-striped.png", nameOverride: "Basculin" },
        { pokemonName: "basculin-white-striped", label: "White Striped Basculin", formKind: "regional", regionOverride: "hisui", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/550-white-striped.png", nameOverride: "Basculin" }
      ],
      554: [
        { pokemonName: "darumaka-galar", label: "Galarian Darumaka", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/554-regional-g.png" }
      ],
      555: [
        { pokemonName: "Darmanitan-zen", label: "Darmanitan (Zen Mode)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/555-zen.png", nameOverride: "Darmanitan" },
        { pokemonName: "Darmanitan-galar-standard", label: "Galarian Darmanitan (Standard Mode)", formKind: "regional", regionOverride: "galar", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/555-regional-g-standard.png", nameOverride: "Darmanitan" },
        { pokemonName: "Darmanitan-galar-zen", label: "Galarian Darmanitan (Zen Mode)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/555-regional-g-zen.png", nameOverride: "Darmanitan" }
      ],
      560: [
        { pokemonName: "scrafty-mega", label: "Mega Scrafty", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/560-mega.png" }
      ],
      562: [
        { pokemonName: "yamask-galar", label: "Galarian Yamask", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/562-regional-g.png" }
      ],
      569: [
        { pokemonName: "garbodor-gmax", label: "G-Max Garbodor", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/569-gmax.png" }
      ],
      570: [
        { pokemonName: "Zorua-hisui", label: "Hisuian Zorua", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/570-regional-h.png" }
      ],
      571: [
        { pokemonName: "Zoroark-hisui", label: "Hisuian Zororak", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/571-regional-h.png" }
      ],
      585: [
        { pokemonName: "deerling", label: "Summer Deerling", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/585-summer.png", nameOverride: "Deerling" },
        { pokemonName: "deerling", label: "Autumn Deerling", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/585-autumn.png", nameOverride: "Deerling" },
        { pokemonName: "deerling", label: "Winter Deerling", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/585-winter.png", nameOverride: "Deerling" }
      ],
      586: [
        { pokemonName: "sawsbuck", label: "Summer Sawsbuck", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/586-summer.png", nameOverride: "Sawsbuck" },
        { pokemonName: "sawsbuck", label: "Autumn Sawsbuck", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/586-autumn.png", nameOverride: "Sawsbuck" },
        { pokemonName: "sawsbuck", label: "Winter Sawsbuck", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/586-winter.png", nameOverride: "Sawsbuck" }
      ],
      604: [
        { pokemonName: "eelektross-mega", label: "Mega Eelektross", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/604-mega.png" }
      ],
      609: [
        { pokemonName: "chandelure-mega", label: "Mega Chandelure", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/609-mega.png" }
      ],
      618: [
        { pokemonName: "stunfisk-galar", label: "Galarian Stunfisk", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/618-regional-g.png" }
      ],
      623: [
        { pokemonName: "golurk-mega", label: "Mega Golurk", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/623-m.png" }
      ],
      628: [
        { pokemonName: "braviary-hisui", label: "Hisuian Braviary", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/628-regional-h.png" }
      ],
      641: [
        { pokemonName: "tornadus-therian", label: "Tornadus (Therian Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/641-therian.png", nameOverride: "Tornadus" }
      ],
      642: [
        { pokemonName: "thundurus-therian", label: "Thundurus (Therian Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/642-therian.png", nameOverride: "Thundurus" }
      ],
      645: [
        { pokemonName: "landorus-therian", label: "Landorus (Therian Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/645-therian.png", nameOverride: "Landorus" }
      ],
      647: [
        { pokemonName: "keldeo-resolute", label: "Keldeo (Resolute Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/647-resolute.png", nameOverride: "Keldeo" }
      ],
      648: [
        { pokemonName: "meloetta-pirouette", label: "Meloetta (Pirouette Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/648-pirouette.png", nameOverride: "meloetta" }
      ],
      649: [
        { primaryTypeOverride: "bug", secondaryTypeOverride: "steel", label: "Genesect (Douse Drive)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/649-douse.png" },
        { primaryTypeOverride: "bug", secondaryTypeOverride: "steel", label: "Genesect (Shock Drive)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/649-shock.png" },
        { primaryTypeOverride: "bug", secondaryTypeOverride: "steel", label: "Genesect (Burn Drive)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/649-burn.png" },
        { primaryTypeOverride: "bug", secondaryTypeOverride: "steel", label: "Genesect (Chill Drive)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/649-chill.png" },
      ],
      652: [
        { pokemonName: "chesnaught-mega", label: "Mega Chesnaught", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/652-mega.png" }
      ],
      655: [
        { pokemonName: "delphox-mega", label: "Mega Delphox", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/655-mega.png" }
      ],
      658: [
        { pokemonName: "greninja-ash", label: "Ash Greninja", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/658-ash.png" },
        { pokemonName: "greninja-mega", label: "Mega Greninja", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/658-mega.png" }
      ],
      666: [
        { pokemonName: "vivillon", label: "Vivillon (Icy Snow Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-icy-snow.png" },
        { pokemonName: "vivillon", label: "Vivillon (Polar Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-polar.png" },
        { pokemonName: "vivillon", label: "Vivillon (Tundra Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-tundra.png" },
        { pokemonName: "vivillon", label: "Vivillon (Continental Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-continental.png" },
        { pokemonName: "vivillon", label: "Vivillon (Garden Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-garden.png" },
        { pokemonName: "vivillon", label: "Vivillon (Elegant Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-elegant.png" },
        { pokemonName: "vivillon", label: "Vivillon (Modern Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-modern.png" },
        { pokemonName: "vivillon", label: "Vivillon (Marine Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-marine.png" },
        { pokemonName: "vivillon", label: "Vivillon (Archipelago Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-archipelago.png" },
        { pokemonName: "vivillon", label: "Vivillon (High Plains Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-high-plains.png" },
        { pokemonName: "vivillon", label: "Vivillon (Sandstorm Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-sandstorm.png" },
        { pokemonName: "vivillon", label: "Vivillon (River Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-river.png" },
        { pokemonName: "vivillon", label: "Vivillon (Monsoon Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-monsoon.png" },
        { pokemonName: "vivillon", label: "Vivillon (Savanna Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-savanna.png" },
        { pokemonName: "vivillon", label: "Vivillon (Sun Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-sun.png" },
        { pokemonName: "vivillon", label: "Vivillon (Ocean Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-ocean.png" },
        { pokemonName: "vivillon", label: "Vivillon (Jungle Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-jungle.png" },
        { pokemonName: "vivillon", label: "Vivillon (Fancy Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-fancy.png" },
        { pokemonName: "vivillon", label: "Vivillon (Pok√©ball Pattern)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-poke-ball.png" }
      ],
      668: [
        {pokemonName: "pyroar-mega", label: "Mega Pyroar", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/668-mega.png" }
      ],
      669: [
        { pokemonName: "flabebe", label: "Flab√©b√© (Yellow Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/669-yellow.png" },
        { pokemonName: "flabebe", label: "Flab√©b√© (Orange Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/669-orange.png" },
        { pokemonName: "flabebe", label: "Flab√©b√© (Blue Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/669-blue.png" },
        { pokemonName: "flabebe", label: "Flab√©b√© (White Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/669-white.png" }
      ],
      670: [
        { pokemonName: "floette", label: "Floette (Yellow Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/670-yellow.png" },
        { pokemonName: "floette", label: "Floette (Orange Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/670-orange.png" },
        { pokemonName: "floette", label: "Floette (Blue Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/670-blue.png" },
        { pokemonName: "floette", label: "Floette (White Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/670-white.png" },
        { pokemonName: "floette", label: "Floette (Eternal Flower)", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/670-eternal.png" },
        { pokemonName: "floette", label: "Mega Floette (Eternal Flower)", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/670-mega.png" }
      ],
      671: [
        { pokemonName: "florges", label: "Florges (Yellow Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/671-yellow.png" },
        { pokemonName: "florges", label: "Florges (Orange Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/671-orange.png" },
        { pokemonName: "florges", label: "Florges (Blue Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/671-blue.png" },
        { pokemonName: "florges", label: "Florges (White Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/671-white.png" }
      ],
      676: [
        { pokemonName: "furfrou", label: "Furfrou (Heart Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-heart.png" },
        { pokemonName: "furfrou", label: "Furfrou (Star Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-star.png" },
        { pokemonName: "furfrou", label: "Furfrou (Diamond Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-diamond.png" },
        { pokemonName: "furfrou", label: "Furfrou (Debutante Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-debutante.png" },
        { pokemonName: "furfrou", label: "Furfrou (Matron Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-matron.png" },
        { pokemonName: "furfrou", label: "Furfrou (Dandy Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-dandy.png" },
        { pokemonName: "furfrou", label: "Furfrou (La Reine Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-la-reine.png" },
        { pokemonName: "furfrou", label: "Furfrou (Kabuki Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-kabuki.png" },
        { pokemonName: "furfrou", label: "Furfrou (Pharaoh Trim)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-pharaoh.png" },
      ],
      678: [
        { pokemonName: "meowstic-female", label: "Meowstic (Female)", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/678-female.png", nameOverride: "Meowstic" },
        { pokemonName: "meowstic-mega", label: "Mega Meowstic", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/678-m.png", nameOverride: "Meowstic" }
      ],
      681: [
        {pokemonName: "aegislash-blade", label: "Aegislash (Blade)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/681-blade.png", nameOverride: "Aegislash" }
      ],
      687: [
        { pokemonName: "malamar-mega", label: "Mega Malamar", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/687-mega.png" }
      ],
      689: [
        { pokemonName: "barbaracle-mega", label: "Mega Barbaracle", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/689-mega.png" }
      ],
      691: [
        { pokemonName: "dragalge-mega", label: "Mega Dragalge", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/691-mega.png" }
      ],
      701: [
        { pokemonName: "hawlucha-mega", label: "Mega Hawlucha", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/701-mega.png" }
      ],
      705: [
        { pokemonName: "sliggoo-hisui", label: "Hisuian Sliggoo", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/705-regional-h.png" }
      ],
      706: [
        { pokemonName: "goodra-hisui", label: "Hisuian Goodra", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/706-regional-h.png" }
      ],
      710: [
        { pokemonName: "pumpkaboo-small", label: "Pumpkaboo (Small Size)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/710-average.png", nameOverride: "Pumpkaboo" },
        { pokemonName: "pumpkaboo-large", label: "Pumpkaboo (Large Size)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/710-large.png", nameOverride: "Pumpkaboo" },
        { pokemonName: "pumpkaboo-super", label: "Pumpkaboo (Super Size)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/710-super.png", nameOverride: "Pumpkaboo" }
      ],
      711: [
        { pokemonName: "gourgeist-small", label: "Gourgeist (Small Size)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/711-average.png", nameOverride: "Gourgeist" },
        { pokemonName: "gourgeist-large", label: "Gourgeist (Large Size)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/711-large.png", nameOverride: "Gourgeist" },
        { pokemonName: "gourgeist-super", label: "Gourgeist (Super Size)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/711-super.png", nameOverride: "Gourgeist" }
      ],
      713: [
        { pokemonName: "avalugg-hisui", label: "Hisuian Avalugg", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/713-regional-h.png" }
      ],
      718: [
        { pokemonName: "zygarde-50", label: "Zygarde (50% Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/718-50.png", nameOverride: "Zygarde" },
        { pokemonName: "zygarde-complete", label: "Zygarde (Complete Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/718-complete.png", nameOverride: "Zygarde" },
        { pokemonName: "zygarde-mega", label: "Mega Zygarde (Complete Forme)", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/718-mega.png", nameOverride: "Zygarde" }
      ],
      719: [
        { pokemonName: "diancie-mega", label: "Mega Diance", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/719-mega.png" }
      ],
      720: [
        { pokemonName: "hoopa-unbound", label: "Hoopa Unbound", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/720-unbound.png" }
      ],
      724: [
        { pokemonName: "decidueye-hisui", label: "Hisuian Decidueye", formKind: "regional", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/724-regional-h.png" }
      ],
      740: [
        { pokemonName: "crabominable-mega", label: "Mega Crabominable", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/740-m.png" }
      ],
      741: [
        { pokemonName: "oricorio-pom-pom", label: "Oricorio (Pom-Pom Style)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/741-pom-pom.png", nameOverride: "Oricorio" },
        { pokemonName: "oricorio-pau", label: "Oricorio (Pau Style)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/741-pau.png", nameOverride: "Oricorio" },
        { pokemonName: "oricorio-sensu", label: "Oricorio (Sensu Style)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/741-sensu.png", nameOverride: "Oricorio" }
      ],
      745: [
        { pokemonName: "lycanroc-dusk", label: "Lycanroc (Dusk Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/745-dusk.png", nameOverride: "Lycanroc" },
        { pokemonName: "lycanroc-midnight", label: "Lycanroc (Midnight Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/745-midnight.png", nameOverride: "Lycanroc" }
      ],
      746: [
        { pokemonName: "wishiwashi-school", label: "Wishiwashi (School Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/746-school.png", nameOverride: "Wishiwashi" }
      ],
      768: [
        { pokemonName: "golisopod-mega", label: "Mega Golisopod", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/768-m.png" }
      ],
      773: [
        { pokemonName: "silvally-bug", label: "Silvally (Bug Type)", primaryTypeOverride: "bug", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-bug.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-dark", label: "Silvally (Dark Type)", primaryTypeOverride: "dark", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-dark.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-dragon", label: "Silvally (Dragon Type)", primaryTypeOverride: "dragon", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-dragon.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-electric", label: "Silvally (Electric Type)", primaryTypeOverride: "electric", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-electric.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-fighting", label: "Silvally (Fighting Type)", primaryTypeOverride: "fighting", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-fighting.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-fire", label: "Silvally (Fire Type)", primaryTypeOverride: "fire", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-fire.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-flying", label: "Silvally (Flying Type)", primaryTypeOverride: "flying", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-flying.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-ghost", label: "Silvally (Ghost Type)", primaryTypeOverride: "ghost", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-ghost.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-grass", label: "Silvally (Grass Type)", primaryTypeOverride: "grass", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-grass.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-ground", label: "Silvally (Ground Type)", primaryTypeOverride: "ground", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-ground.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-ice", label: "Silvally (Ice Type)", primaryTypeOverride: "ice", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-ice.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-poison", label: "Silvally (Poison Type)", primaryTypeOverride: "poison", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-poison.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-psychic", label: "Silvally (Psychic Type)", primaryTypeOverride: "psychic", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-psychic.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-rock", label: "Silvally (Rock Type)", primaryTypeOverride: "rock", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-rock.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-steel", label: "Silvally (Steel Type)", primaryTypeOverride: "steel", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-steel.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-water", label: "Silvally (Water Type)", primaryTypeOverride: "water", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-water.png", nameOverride: "Silvally" },
        { pokemonName: "silvally-fairy", label: "Silvally (Fairy Type)", primaryTypeOverride: "fairy", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-fairy.png", nameOverride: "Silvally" },
      ],
      774: [
        { pokemonName: "minior-red-meteor", label: "Minior (Red Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-red.png", nameOverride: "Minior" },
        { pokemonName: "minior-orange-meteor", label: "Minior (Orange Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-orange.png", nameOverride: "Minior" },
        { pokemonName: "minior-yellow-meteor", label: "Minior (Yellow Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-yellow.png", nameOverride: "Minior" },
        { pokemonName: "minior-green-meteor", label: "Minior (Green Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-green.png", nameOverride: "Minior" },
        { pokemonName: "minior-blue-meteor", label: "Minior (Blue Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-blue.png", nameOverride: "Minior" },
        { pokemonName: "minior-indigo-meteor", label: "Minior (Indigo Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-indigo.png", nameOverride: "Minior" },
        { pokemonName: "minior-violet-meteor", label: "Minior (Violet Core)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/774-violet.png", nameOverride: "Minior" },
      ],
      780: [
        { pokemonName: "drampa-mega", label: "Mega Drampa", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/780-mega.png" }
      ],
      800: [
        { pokemonName: "necrozma-dusk", label: "Dusk Mane Necroma", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/800-dusk.png" },
        { pokemonName: "necrozma-dawn", label: "Dawn Wings Necroma", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/800-dawn.png" },
        { pokemonName: "necrozma-ultra", label: "Ultra Necroma", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/800-ultra.png" }
      ],
      801: [
        { pokemonName: "magearna", label: "Mega Magearna", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/801-m.png" },
        { pokemonName: "magearna-original", label: "Magearna (Original Color)", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/801-original.png" },
        { pokemonName: "magearna-original", label: "Mega Magearna (Original Color)", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/801-mega-original.png" }
      ],
      807: [
        { pokemonName: "zeraora-mega", label: "Mega Zeraora", primaryTypeOverride: "electric", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/807-m.png" }
      ],
      809: [
        { pokemonName: "melmetal-gmax", label: "G-Max Melmetal", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/render/809-gmax.png" }
      ],
      812: [
        { pokemonName: "rillaboom-gmax", label: "G-Max Rillaboom", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/812-gmax.png" }
      ],
      815: [
        { pokemonName: "cinderace-gmax", label: "G-Max Cinderace", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/815-gmax.png" }
      ],
      818: [
        { pokemonName: "inteleon-gmax", label: "G-Max Inteleon", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/818-gmax.png" }
      ],
      823: [
        { pokemonName: "corviknight-gmax", label: "G-Max Corviknight", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/823-gmax.png" }
      ],
      826: [
        { pokemonName: "orbeetle-gmax", label: "G-Max Orbeetle", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/826-gmax.png" }
      ],
      834: [
        { pokemonName: "drednaw-gmax", label: "G-Max Drednaw", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/834-gmax.png" }
      ],
      839: [
        { pokemonName: "coalossal-gmax", label: "G-Max Coalossal", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/839-gmax.png" }
      ],
      841: [
        { pokemonName: "flapple-gmax", label: "G-Max Flapple", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/841-gmax.png" }
      ],
      842: [
        { pokemonName: "appletun-gmax", label: "G-Max Appletun", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/841-gmax.png" }
      ],
      844: [
        { pokemonName: "sandaconda-gmax", label: "G-Max Sandaconda", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/844-gmax.png" }
      ],
      849: [
        { pokemonName: "toxtricity-amped", label: "Toxtricity (Amped Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/849-amped.png", nameOverride: "Toxtricity" },
        { pokemonName: "toxtricity-amped-gmax", label: "G-Max Toxtricity", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/849-gmax.png", nameOverride: "Toxtricity" }
      ],
      851: [
        { pokemonName: "centiskorch-gmax", label: "G-Max Centiskorch", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/851-gmax.png" }
      ],
      858: [
        { pokemonName: "hatterene-gmax", label: "G-Max Hatterene", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/858-gmax.png" }
      ],
      861: [
        { pokemonName: "grimmsnarl-gmax", label: "G-Max Grimmsnarl", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/861-gmax.png" }
      ],
      869: [
        { pokemonName: "alcremie", label: "Alcremie (Vanilla Cream/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Vanilla Cream/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Vanilla Cream/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Vanilla Cream/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Vanilla Cream/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Vanilla Cream/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Cream/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-cream-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Matcha Cream/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-matcha-cream-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Salted Cream/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-salted-cream-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Lemon Cream/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-lemon-cream-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Mint Cream/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-mint-cream-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Caramel Swirl/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-caramel-swirl-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Ruby Swirl/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-ruby-swirl-love-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Strawberry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-strawberry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Flower)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-flower-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Star)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-star-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Clover)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-clover-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Berry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-berry-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Ribbon)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-ribbon-sweet.png" },
        { pokemonName: "alcremie", label: "Alcremie (Rainbow Swirl/Love)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-rainbow-swirl-love-sweet.png" },
        { pokemonName: "alcremie-gmax", label: "G-Max Alcremie", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-gmax.png" }
      ],
      870: [
        { pokemonName: "falinks-mega", label: "Mega Falinks", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/870-mega.png" }
      ],
      875: [
        { pokemonName: "eiscue-noice", label: "Eiscue (Noice Face)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/875-noice.png", nameOverride: "Eiscue" }
      ],
      876: [
        { pokemonName: "indeedee-female", label: "Indeedee (Female)", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/876-female.png", nameOverride: "Indeedee" }
      ],
      877: [
        { pokemonName: "morpeko-hangry", label: "Morpeko (Hangry)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/877-hangry.png", nameOverride: "Morpeko" }
      ],
      879: [
        { pokemonName: "copperajah-gmax", label: "G-Max Copperajah", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/879-gmax.png" }
      ],
      884: [
        { pokemonName: "duraludon-gmax", label: "G-Max Duraludon", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/884-gmax.png" }
      ],
      888: [
        { pokemonName: "zacian-crowned", label: "Crowned Sword Zacian", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/888-crowned.png", nameOverride: "Zacian" }
      ],
      889: [
        { pokemonName: "zamazenta-crowned", label: "Crowned Shield Zamazenta", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/889-crowned.png", nameOverride: "Zamazenta" }
      ],
      890: [
        { pokemonName: "eternatus-eternamax", label: "Eternamax Eternatus", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/890-eternamax.png" }
      ],
      892: [
        { pokemonName: "urshifu-single-strike-gmax", label: "G-Max Single Strike Urshifu", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/892-single-strike-gmax.png", nameOverride: "Urshifu" },
        { pokemonName: "urshifu-rapid-strike", label: "Rapid Strike Urshifu", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/892-rapid-strike.png", nameOverride: "Urshifu" },
        { pokemonName: "urshifu-rapid-strike-gmax", label: "G-Max Rapid Strike Urshifu", formKind: "gmax", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/892-rapid-strike-gmax.png", nameOverride: "Urshifu" }
      ],
      893: [
        { pokemonName: "zarude-dada", label: "Dada Zarude", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/893-dada.png" }
      ],
      898: [
        { pokemonName: "calyrex-ice", label: "Ice Rider Calyrex", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/898-ice.png" },
        { pokemonName: "calyrex-shadow", label: "Shadow Rider Calyrex", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/898-shadow.png" }
      ],
      901: [
        { pokemonName: "ursaluna-bloodmoon", label: "Bloodmoon Ursaluna", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/901-bloodmoon.png" }
      ],
      902: [
        { pokemonName: "basculegion-female", label: "Basculegion (Female)", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/902-female.png", nameOverride: "Basculegion" }
      ],
      905: [
        { pokemonName: "enamorus-therian", label: "Enamorus (Therian Forme)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/905-therian.png", nameOverride: "Enamorus" }
      ],
      916: [
        { pokemonName: "oinkologne-female", label: "Oinkologne (Female)", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/916-female.png", nameOverride: "Oinkologne" }
      ],
      925: [
        { pokemonName: "maushold-family-of-four", label: "Maushold (Family of Four)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/925-family-of-four.png", nameOverride: "Maushold" }
      ],
      931: [
        { pokemonName: "squawkabilly-blue-plumage", label: "Squawkabilly (Blue Plumage)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/931-blue.png", nameOverride: "Squawkabilly" },
        { pokemonName: "squawkabilly-yellow-plumage", label: "Squawkabilly (Yellow Plumage)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/931-yellow.png", nameOverride: "Squawkabilly" },
        { pokemonName: "squawkabilly-white-plumage", label: "Squawkabilly (White Plumage)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/931-white.png", nameOverride: "Squawkabilly" }
      ],
      952: [
        { pokemonName: "scovillain-mega", label: "Mega Scovillain", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/952-m.png" }
      ],
      964: [
        { pokemonName: "palafin-hero", label: "Palafin (Hero Form)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/964-hero.png", nameOverride: "Palafin" }
      ],
      970: [
        { pokemonName: "glimmora-mega", label: "Mega Glimmora", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/970-m.png" }
      ],
      978: [
        { pokemonName: "tatsugiri-curly", label: "Mega Tatsugiri (Curly Form)", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/978-m.png", nameOverride: "Tatsugiri" },
        { pokemonName: "tatsugiri-droopy", label: "Tatsugiri (Droopy Form)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/978-droopy.png", nameOverride: "Tatsugiri" },
        { pokemonName: "tatsugiri-droopy", label: "Mega Tatsugiri (Droopy Form)", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/978-md.png", nameOverride: "Tatsugiri" },
        { pokemonName: "tatsugiri-stretchy", label: "Tatsugiri (Stretchy Form)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/978-stretchy.png", nameOverride: "Tatsugiri" },
        { pokemonName: "tatsugiri-stretchy", label: "Mega Tatsugiri (Stretchy Form)", formKind: "mega", spriteOverride: "https://www.serebii.net/legendsz-a/pokemon/978-ms.png", nameOverride: "Tatsugiri" }
      ],
      982: [
        { pokemonName: "dudunsparce-three-segment", label: "Dudunsparce (Three Segment)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/982-three-segment.png", nameOverride: "Dudunsparce" }
      ],
      998: [
        { pokemonName: "baxcalibur", label: "Mega Baxcalibur", formKind: "mega", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/998-mega.png" }
      ],
      999: [
        { pokemonName: "gimmighoul-roaming", label: "Gimmighoul (Roaming Form)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/999-roaming.png" }
      ],
      1017: [
        { pokemonName: "ogerpon", label: "Ogerpon (Terastal Teal Mask)", formKind: "special", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/1017-teal-mask-tera.png" },
        { pokemonName: "ogerpon-wellspring-mask", label: "Ogerpon (Wellspring Mask)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/1017-wellspring-mask.png" },
        { pokemonName: "ogerpon-wellspring-mask", label: "Ogerpon (Terastal Wellspring Mask)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/1017-wellspring-mask-tera.png" },
        { pokemonName: "ogerpon-hearthflame-mask", label: "Ogerpon (Hearthflame Mask)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/1017-hearthflame-mask.png" },
        { pokemonName: "ogerpon-hearthflame-mask", label: "Ogerpon (Terastal Hearthflame Mask)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/1017-hearthflame-mask-tera.png" },
        { pokemonName: "ogerpon-cornerstone-mask", label: "Ogerpon (Cornerstone Mask)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/1017-cornerstone-mask.png" },
        { pokemonName: "ogerpon-cornerstone-mask", label: "Ogerpon (Terastal Cornerstone Mask)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/1017-cornerstone-mask-tera.png" }
      ],
      1024: [
        { pokemonName: "terapagos-tera", label: "Terapagos (Terastal Form)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/1024-tera.png" },
        { pokemonName: "terapagos-stellar", label: "Terapagos (Stellar Form)", formKind: "variant", spriteOverride: "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/1024-stellar.png" }
      ]
    };

    const STORAGE_KEY = "favoritePokemonSorter_v2";

    // Type colors
    const TYPE_COLORS = {
      normal: "#A8A77A",
      fire: "#EE8130",
      water: "#6390F0",
      electric: "#F7D02C",
      grass: "#7AC74C",
      ice: "#96D9D6",
      fighting: "#C22E28",
      poison: "#A33EA1",
      ground: "#E2BF65",
      flying: "#A98FF3",
      psychic: "#F95587",
      bug: "#A6B91A",
      rock: "#B6A136",
      ghost: "#735797",
      dragon: "#6F35FC",
      dark: "#705746",
      steel: "#B7B7CE",
      fairy: "#D685AD"
    };

    // --- STATE ---

    // Each entry = { dexId, pokemonName, displayName?, isForm, formKind? }
    let allEntries = [];
    let baseEntries = []; // unfiltered/unordered master list

    // ordering modes: national | families | staged | random
    let orderingMode = "national";

    // Custom family ordering (used by "Ordered Families" mode).
    // Edit/extend this list to control exact family + within-family order.
    // Notes:
    // - Use Pok√©API-style slugs (lowercase, hyphens). Spaces/apostrophes will be normalized.
    // - Regional/alternate forms are automatically placed right after their base form
    //   (e.g., vulpix, vulpix-alola, ninetales, ninetales-alola) as long as they share the same National Dex number.
    const ORDERED_FAMILIES_GROUPS = [
      ["bulbasaur","ivysaur","venusaur"],
      ["charmander","charmeleon","charizard"],
      ["squirtle","wartortle","blastoise"],
      ["caterpie","metapod","butterfree"],
      ["weedle","kakuna","beedrill"],
      ["pidgey","pidgeotto","pidgeot"],
      ["rattata","raticate"],
      ["spearow","fearow"],
      ["ekans","arbok"],
      ["pichu","pikachu","raichu"],
      ["sandshrew","sandslash"],
      ["nidoran-f","nidorina","nidoqueen"],
      ["nidoran-m","nidorino","nidoking"],
      ["cleffa","clefairy","clefable"],
      ["vulpix","ninetales"],
      ["igglybuff","jigglypuff","wigglytuff"],
      ["zubat","golbat","crobat"],
      ["oddish","gloom","vileplume","bellossom"],
      ["paras","parasect"],
      ["venonat","venomoth"],
      ["diglett","dugtrio"],
      ["meowth","persian","perrserker"],
      ["psyduck","golduck"],
      ["mankey","primeape","annihilape"],
      ["growlithe","arcanine"],
      ["poliwag","poliwhirl","poliwrath","politoed"],
      ["abra","kadabra","alakazam"],
      ["machop","machoke","machamp"],
      ["bellsprout","weepinbell","victreebel"],
      ["tentacool","tentacruel"],
      ["geodude","graveler","golem"],
      ["ponyta","rapidash"],
      ["slowpoke","slowbro","slowking"],
      ["magnemite","magneton","magnezone"],
      ["farfetchd","sirfetchd"],
      ["doduo","dodrio"],
      ["seel","dewgong"],
      ["grimer","muk"],
      ["shellder","cloyster"],
      ["gastly","haunter","gengar"],
      ["onix","steelix"],
      ["drowzee","hypno"],
      ["krabby","kingler"],
      ["voltorb","electrode"],
      ["exeggcute","exeggutor"],
      ["cubone","marowak"],
      ["tyrogue","hitmonlee","hitmonchan","hitmontop"],
      ["lickitung","lickilicky"],
      ["koffing","weezing"],
      ["rhyhorn","rhydon","rhyperior"],
      ["happiny","chansey","blissey"],
      ["tangela","tangrowth"],
      ["kangaskhan"],
      ["horsea","seadra","kingdra"],
      ["goldeen","seaking"],
      ["staryu","starmie"],
      ["mime-jr","mr-mime","mr-rime"],
      ["scyther","scizor","kleavor"],
      ["smoochum","jynx"],
      ["elekid","electabuzz","electivire"],
      ["magby","magmar","magmortar"],
      ["pinsir"],
      ["tauros"],
      ["magikarp","gyarados"],
      ["lapras"],
      ["ditto"],
      ["eevee","vaporeon","jolteon","flareon","espeon","umbreon","leafeon","glaceon","sylveon"],
      ["porygon","porygon2","porygon-z"],
      ["omanyte","omastar"],
      ["kabuto","kabutops"],
      ["aerodactyl"],
      ["munchlax","snorlax"],
      ["articuno"],
      ["zapdos"],
      ["moltres"],
      ["dratini","dragonair","dragonite"],
      ["mewtwo"],
      ["mew"],
      ["chikorita","bayleef","meganium"],
      ["cyndaquil","quilava","typhlosion"],
      ["totodile","croconaw","feraligatr"],
      ["sentret","furret"],
      ["hoothoot","noctowl"],
      ["ledyba","ledian"],
      ["spinarak","ariados"],
      ["chinchou","lanturn"],
      ["togepi","togetic","togekiss"],
      ["natu","xatu"],
      ["mareep","flaaffy","ampharos"],
      ["azurill","marill","azumarill"],
      ["bonsly","sudowoodo"],
      ["hoppip","skiploom","jumpluff"],
      ["aipom","ambipom"],
      ["sunkern","sunflora"],
      ["yanma","yanmega"],
      ["wooper","quagsire","clodsire"],
      ["murkrow","honchkrow"],
      ["misdreavus","mismagius"],
      ["unown"],
      ["wynaut","wobbuffet"],
      ["girafarig","farigiraf"],
      ["pineco","forretress"],
      ["dunsparce","dudunsparce-two-segment"],
      ["gligar","gliscor"],
      ["snubbull","granbull"],
      ["qwilfish","overqwil"],
      ["shuckle"],
      ["heracross"],
      ["sneasel","weavile","sneasler"],
      ["teddiursa","ursaring","ursaluna"],
      ["slugma","magcargo"],
      ["swinub","piloswine","mamoswine"],
      ["corsola","cursola"],
      ["remoraid","octillery"],
      ["delibird"],
      ["mantyke","mantine"],
      ["skarmory"],
      ["houndour","houndoom"],
      ["phanpy","donphan"],
      ["stantler","wyrdeer"],
      ["smeargle"],
      ["miltank"],
      ["raikou"],
      ["entei"],
      ["suicune"],
      ["larvitar","pupitar","tyranitar"],
      ["lugia"],
      ["ho-oh"],
      ["celebi"],
      ["treecko","grovyle","sceptile"],
      ["torchic","combusken","blaziken"],
      ["Mudkip","marshtomp","swampert"],
      ["poochyena","mightyena"],
      ["zigzagoon","linoone","obstagoon"],
      ["wurmple","silcoon","beautifly","cascoon","dustox"],
      ["lotad","lombre","ludicolo"],
      ["seedot","nuzleaf","shiftry"],
      ["taillow","swellow"],
      ["wingull","pelipper"],
      ["ralts","kirlia","gardevoir","gallade"],
      ["surskit","masquerain"],
      ["shroomish","breloom"],
      ["slakoth","vigoroth","slaking"],
      ["nincada","ninjask","shedinja"],
      ["whismur","loudred","exploud"],
      ["makuhita","hariyama"],
      ["nosepass","probopass"],
      ["skitty","delcatty"],
      ["sableye"],
      ["mawile"],
      ["aron","lairon","aggron"],
      ["meditite","medicham"],
      ["electrike","manectric"],
      ["plusle"],
      ["minun"],
      ["volbeat"],
      ["illumise"],
      ["budew","roselia","roserade"],
      ["gulpin","swalot"],
      ["carvanha","sharpedo"],
      ["wailmer","wailord"],
      ["numel","camerupt"],
      ["torkoal"],
      ["spoink","grumpig"],
      ["spinda"],
      ["trapinch","vibrava","flygon"],
      ["cacnea","cacturne"],
      ["swablu","altaria"],
      ["zangoose"],
      ["seviper"],
      ["lunatone"],
      ["solrock"],
      ["barboach","whiscash"],
      ["corphish","crawdaunt"],
      ["baltoy","claydol"],
      ["lileep","cradily"],
      ["anorith","armaldo"],
      ["feebas","milotic"],
      ["castform"],
      ["kecleon"],
      ["shuppet","banette"],
      ["duskull","dusclops","dusknoir"],
      ["tropius"],
      ["chingling","chimecho"],
      ["absol"],
      ["snorunt","glalie","froslass"],
      ["spheal","sealeo","walrein"],
      ["clamperl","huntail","gorebyss"],
      ["relicanth"],
      ["luvdisc"],
      ["bagon","shelgon","salamence"],
      ["beldum","metang","metagross"],
      ["regirock"],
      ["regice"],
      ["registeel"],
      ["latios"],
      ["latias"],
      ["kyogre"],
      ["groudon"],
      ["rayquaza"],
      ["jirachi"],
      ["deoxys-normal"],
      ["turtwig","grotle","torterra"],
      ["chimchar","monferno","infernape"],
      ["piplup","prinplup","empoleon"],
      ["starly","staravia","staraptor"],
      ["bidoof","bibarel"],
      ["kricketot","kricketune"],
      ["shinx","luxio","luxray"],
      ["cranidos","rampardos"],
      ["shieldon","bastiodon"],
      ["burmy","wormadam-plant","mothim"],
      ["combee","vespiquen"],
      ["pachirisu"],
      ["buizel","floatzel"],
      ["cherubi","cherrim"],
      ["shellos","gastrodon"],
      ["drifloon","drifblim"],
      ["buneary","lopunny"],
      ["glameow","purugly"],
      ["stunky","skuntank"],
      ["bronzor","bronzong"],
      ["chatot"],
      ["spiritomb"],
      ["gible","gabite","garchomp"],
      ["riolu","lucario"],
      ["hippopotas","hippowdon"],
      ["skorupi","drapion"],
      ["croagunk","toxicroak"],
      ["carnivine"],
      ["finneon","lumineon"],
      ["snover","abomasnow"],
      ["rotom"],
      ["uxie"],
      ["mesprit"],
      ["azelf"],
      ["dialga"],
      ["palkia"],
      ["heatran"],
      ["regigigas"],
      ["giratina-altered"],
      ["cresselia"],
      ["phione","manaphy"],
      ["darkrai"],
      ["shaymin-land"],
      ["arceus"],
      ["victini"],
      ["snivy","servine","serperior"],
      ["tepig","pignite","emboar"],
      ["oshawott","dewott","samurott"],
      ["patrat","watchog"],
      ["lillipup","herdier","stoutland"],
      ["purrloin","liepard"],
      ["pansage","simisage"],
      ["pansear","simisear"],
      ["panpour","simipour"],
      ["munna","musharna"],
      ["pidove","tranquill","unfezant"],
      ["blitzle","zebstrika"],
      ["roggenrola","boldore","gigalith"],
      ["woobat","swoobat"],
      ["drilbur","excadrill"],
      ["audino"],
      ["timburr","gurdurr","conkeldurr"],
      ["tympole","palpitoad","seismitoad"],
      ["throh"],
      ["sawk"],
      ["sewaddle","swadloon","leavanny"],
      ["venipede","whirlipede","scolipede"],
      ["cottonee","whimsicott"],
      ["petilil","lilligant"],
      ["basculin-red-striped","basculegion-male"],
      ["sandile","krokorok","krookodile"],
      ["darumaka","darmanitan-standard"],
      ["maractus"],
      ["dwebble","crustle"],
      ["scraggy","scrafty"],
      ["sigilyph"],
      ["yamask","cofagrigus","runerigus"],
      ["tirtouga","carracosta"],
      ["archen","archeops"],
      ["trubbish","garbodor"],
      ["zorua","zoroark"],
      ["minccino","cinccino"],
      ["gothita","gothorita","gothitelle"],
      ["solosis","duosion","reuniclus"],
      ["ducklett","swanna"],
      ["vanillite","vanillish","vanilluxe"],
      ["deerling","sawsbuck"],
      ["emolga"],
      ["karrablast","escavalier"],
      ["foongus","amoonguss"],
      ["frillish","jellicent"],
      ["alomomola"],
      ["joltik","galvantula"],
      ["ferroseed","ferrothorn"],
      ["klink","klang","klinklang"],
      ["tynamo","eelektrik","eelektross"],
      ["elgyem","beheeyem"],
      ["litwick","lampent","chandelure"],
      ["axew","fraxure","haxorus"],
      ["cubchoo","beartic"],
      ["cryogonal"],
      ["shelmet","accelgor"],
      ["stunfisk"],
      ["mienfoo","mienshao"],
      ["druddigon"],
      ["golett","golurk"],
      ["pawniard","bisharp","kingambit"],
      ["bouffalant"],
      ["rufflet","braviary"],
      ["vullaby","mandibuzz"],
      ["heatmor"],
      ["durant"],
      ["deino","zweilous","hydreigon"],
      ["larvesta","volcarona"],
      ["cobalion"],
      ["terrakion"],
      ["virizion"],
      ["tornadus-incarnate"],
      ["thundurus-incarnate"],
      ["reshiram"],
      ["zekrom"],
      ["landorus-incarnate"],
      ["kyurem"],
      ["keldeo-ordinary"],
      ["meloetta-aria"],
      ["genesect"],
      ["chespin","quilladin","chesnaught"],
      ["fennekin","braixen","delphox"],
      ["froakie","frogadier","greninja"],
      ["bunnelby","diggersby"],
      ["fletchling","fletchinder","talonflame"],
      ["scatterbug","spewpa","vivillon"],
      ["litleo","pyroar"],
      ["flabebe","floette","florges"],
      ["skiddo","gogoat"],
      ["pancham","pangoro"],
      ["furfrou"],
      ["espurr","meowstic-male"],
      ["honedge","doublade","aegislash-shield"],
      ["spritzee","aromatisse"],
      ["swirlix","slurpuff"],
      ["inkay","malamar"],
      ["binacle","barbaracle"],
      ["skrelp","dragalge"],
      ["clauncher","clawitzer"],
      ["helioptile","heliolisk"],
      ["tyrunt","tyrantrum"],
      ["amaura","aurorus"],
      ["hawlucha"],
      ["dedenne"],
      ["carbink"],
      ["goomy","sliggoo","goodra"],
      ["klefki"],
      ["phantump","trevenant"],
      ["pumpkaboo-average","gourgeist-average"],
      ["bergmite","avalugg"],
      ["noibat","noivern"],
      ["xerneas"],
      ["yveltal"],
      ["zygarde-10"],
      ["diancie"],
      ["hoopa"],
      ["volcanion"],
      ["rowlet","dartrix","decidueye"],
      ["litten","torracat","incineroar"],
      ["popplio","brionne","primarina"],
      ["pikipek","trumbeak","toucannon"],
      ["yungoos","gumshoos"],
      ["grubbin","charjabug","vikavolt"],
      ["crabrawler","crabominable"],
      ["oricorio-baile"],
      ["cutiefly","ribombee"],
      ["rockruff","lycanroc-midday"],
      ["wishiwashi-solo"],
      ["mareanie","toxapex"],
      ["mudbray","mudsdale"],
      ["dewpider","araquanid"],
      ["fomantis","lurantis"],
      ["morelull","shiinotic"],
      ["salandit","salazzle"],
      ["stufful","bewear"],
      ["bounsweet","steenee","tsareena"],
      ["comfey"],
      ["oranguru"],
      ["passimian"],
      ["wimpod","golisopod"],
      ["sandygast","palossand"],
      ["pyukumuku"],
      ["type-null","silvally-normal"],
      ["minior-red-meteor"],
      ["komala"],
      ["turtonator"],
      ["togedemaru"],
      ["mimikyu-disguised"],
      ["bruxish"],
      ["drampa"],
      ["dhelmise"],
      ["jangmo-o","hakamo-o","kommo-o"],
      ["tapu-koko"],
      ["tapu-lele"],
      ["tapu-bulu"],
      ["tapu-fini"],
      ["cosmog","cosmoem","solgaleo","lunala"],
      ["nihilego"],
      ["buzzwole"],
      ["pheromosa"],
      ["xurkitree"],
      ["celesteela"],
      ["kartana"],
      ["guzzlord"],
      ["necrozma"],
      ["magearna"],
      ["marshadow"],
      ["poipole","naganadel"],
      ["stakataka"],
      ["blacephalon"],
      ["zeraora"],
      ["meltan","melmetal"],
      ["grookey","thwackey","rillaboom"],
      ["scorbunny","raboot","cinderace"],
      ["sobble","drizzile","inteleon"],
      ["skwovet","greedent"],
      ["rookidee","corvisquire","corviknight"],
      ["blipbug","dottler","orbeetle"],
      ["nickit","thievul"],
      ["gossifleur","eldegoss"],
      ["wooloo","dubwool"],
      ["chewtle","drednaw"],
      ["yamper","boltund"],
      ["rolycoly","carkol","coalossal"],
      ["applin","flapple","appletun","dipplin","hydrapple"],
      ["silicobra","sandaconda"],
      ["cramorant"],
      ["arrokuda","barraskewda"],
      ["toxel","toxtricity-low-key"],
      ["sizzlipede","centiskorch"],
      ["clobbopus","grapploct"],
      ["sinistea","polteageist"],
      ["hatenna","hattrem","hatterene"],
      ["impidimp","morgrem","grimmsnarl"],
      ["milcery","alcremie"],
      ["falinks"],
      ["pincurchin"],
      ["snom","frosmoth"],
      ["stonjourner"],
      ["eiscue-ice"],
      ["indeedee-male"],
      ["morpeko-full-belly"],
      ["cufant","copperajah"],
      ["dracozolt"],
      ["arctozolt"],
      ["dracovish"],
      ["arctovish"],
      ["duraludon","archaludon"],
      ["dreepy","drakloak","dragapult"],
      ["zacian"],
      ["zamazenta"],
      ["eternatus"],
      ["kubfu","urshifu-single-strike"],
      ["zarude"],
      ["regieleki"],
      ["regidrago"],
      ["glastrier"],
      ["spectrier"],
      ["calyrex"],
      ["enamorus-incarnate"],
      ["sprigatito","floragato","meowscarada"],
      ["fuecoco","crocalor","skeledirge"],
      ["quaxly","quaxwell","quaquaval"],
      ["lechonk","oinkologne-male"],
      ["tarountula","spidops"],
      ["nymble","lokix"],
      ["pawmi","pawmo","pawmot"],        
      ["tandemaus","maushold-family-of-three"],
      ["fidough","dachsbun"],
      ["smoliv","dolliv","arboliva"],
      ["squawkabilly-green-plumage"],
      ["nacli","naclstack","garganacl"],
      ["charcadet","armarouge","ceruledge"],
      ["tadbulb","bellibolt"],
      ["wattrel","Kilowattrel"],
      ["maschiff","mabosstiff"],
      ["shroodle","grafaiai"],
      ["bramblin","brambleghast"],
      ["toedscool","toedscruel"],
      ["klawf"],
      ["capsakid","scovillain"],
      ["rellor","rabsca"],
      ["flittle","espathra"],
      ["tinkatink","tinkatuff","tinkaton"],
      ["wiglett","wugtrio"],
      ["bombirdier"],
      ["finizen","palafin-zero"],
      ["varoom","revavroom"],
      ["cyclizar"],
      ["orthworm"],
      ["glimmet","glimmora"],
      ["greavard","houndstone"],
      ["flamigo"],
      ["cetoddle","cetitan"],
      ["veluza"],
      ["dondozo"],
      ["tatsugiri-curly"],
      ["great-tusk"],
      ["scream-tail"],
      ["brute-bonnet"],
      ["flutter-mane"],
      ["slither-wing"],
      ["sandy-shocks"],
      ["iron-treads"],
      ["iron-bundle"],
      ["iron-hands"],
      ["iron-jugulis"],
      ["iron-moth"],
      ["iron-thorns"],
      ["frigibax","arctibax","baxcalibur"],
      ["gimmighoul","gholdengo"],
      ["wo-chien"],
      ["chien-pao"],
      ["ting-lu"],
      ["chi-yu"],
      ["roaring-moon"],
      ["iron-valiant"],
      ["koraidon"],
      ["miraidon"],
      ["walking-wake"],
      ["iron-leaves"],
      ["poltchageist","sinistcha"],
      ["okidogi"],
      ["munkidori"],
      ["fezandipiti"],
      ["ogerpon"],
      ["gouging-fire"],
      ["raging-bolt"],
      ["iron-boulder"],
      ["iron-crown"],
      ["terapagos"],
      ["pecharunt"]
    ];

    let ranking = [];              // array of indices into allEntries
    let currentInsertIndex = null; // index into allEntries
    let compareRankPos = null;     // index into ranking
    let mode = "idle";             // "idle" | "initial" | "inserting" | "done"

// Tie groups:
// entryIndex (into allEntries) -> tieGroupId (number). Entries with the same tieGroupId are treated as a block.
let tieGroupByEntry = {};
let nextTieGroupId = 1;

// Undo stack: snapshots of state before each user action.
let actionHistory = []; // array of { ranking, currentInsertIndex, compareRankPos, mode, tieGroupByEntry, nextTieGroupId }
const MAX_HISTORY = 40;

function cloneTieMap(map) {
  return Object.assign({}, map || {});
}

function pushHistorySnapshot() {
  actionHistory.push({
    ranking: ranking.slice(),
    currentInsertIndex,
    compareRankPos,
    mode,
    tieGroupByEntry: cloneTieMap(tieGroupByEntry),
    nextTieGroupId
  });
  if (actionHistory.length > MAX_HISTORY) actionHistory.shift();
  undoBtn.disabled = actionHistory.length === 0;
}

function restoreSnapshot(snap) {
  ranking = Array.isArray(snap.ranking) ? snap.ranking.slice() : [];
  currentInsertIndex =
    typeof snap.currentInsertIndex === "number" ? snap.currentInsertIndex : null;
  compareRankPos =
    typeof snap.compareRankPos === "number" ? snap.compareRankPos : null;
  mode = snap.mode || "idle";
  tieGroupByEntry = cloneTieMap(snap.tieGroupByEntry);
  nextTieGroupId = typeof snap.nextTieGroupId === "number" ? snap.nextTieGroupId : 1;
}

function getGroupIdForEntry(entryIndex) {
  const gid = tieGroupByEntry[String(entryIndex)];
  return typeof gid === "number" ? gid : null;
}

function getGroupStartPos(pos) {
  if (pos === null || pos <= 0) return pos;
  const curEntry = ranking[pos];
  const gid = getGroupIdForEntry(curEntry);
  if (!gid) return pos;
  let p = pos;
  while (p > 0) {
    const prevEntry = ranking[p - 1];
    if (getGroupIdForEntry(prevEntry) !== gid) break;
    p--;
  }
  return p;
}

function getGroupEndPos(pos) {
  if (pos === null || pos >= ranking.length - 1) return pos;
  const curEntry = ranking[pos];
  const gid = getGroupIdForEntry(curEntry);
  if (!gid) return pos;
  let p = pos;
  while (p < ranking.length - 1) {
    const nextEntry = ranking[p + 1];
    if (getGroupIdForEntry(nextEntry) !== gid) break;
    p++;
  }
  return p;
}

function ensureGroupForEntries(aEntryIndex, bEntryIndex) {
  const aG = getGroupIdForEntry(aEntryIndex);
  const bG = getGroupIdForEntry(bEntryIndex);
  if (aG && bG) {
    const keep = Math.min(aG, bG);
    const drop = Math.max(aG, bG);
    Object.keys(tieGroupByEntry).forEach((k) => {
      if (tieGroupByEntry[k] === drop) tieGroupByEntry[k] = keep;
    });
    return keep;
  }
  if (aG) {
    tieGroupByEntry[String(bEntryIndex)] = aG;
    return aG;
  }
  if (bG) {
    tieGroupByEntry[String(aEntryIndex)] = bG;
    return bG;
  }
  const gid = nextTieGroupId++;
  tieGroupByEntry[String(aEntryIndex)] = gid;
  tieGroupByEntry[String(bEntryIndex)] = gid;
  return gid;
}

function undoLastAction() {
  if (actionHistory.length === 0) return;
  const snap = actionHistory.pop();
  restoreSnapshot(snap);
  updateRankingUI();

  if (mode === "initial") {
    statusMain.textContent = "Round 1: Pick between Bulbasaur and Ivysaur.";
    compareTitle.textContent = "Which do you like more to start?";
    setCardContent("left", 0);
    setCardContent("right", 1);
    updateButtonsEnabled(true);
  } else if (mode === "inserting") {
    updateInsertionStatusTexts();
    showCurrentComparison();
    updateButtonsEnabled(true);
  } else {
    updateButtonsEnabled(false);
  }

  log("Undid your last action.");
  saveState();
}

    // pokemonName -> { sprite, primaryType, secondaryType }
    const pokemonInfoCache = {};

    // --- UI ELEMENTS ---

    const statusMain = { textContent: "" };
    const startBtn = document.getElementById("start-btn");
    const undoBtn = document.getElementById("undo-btn");
    const tieBtn = document.getElementById("tie-btn");
    const resetBtn = document.getElementById("reset-btn");
    const compareTitle = document.getElementById("compare-title");

    const nameLeft = document.getElementById("name-left");
    const idLeft = document.getElementById("id-left");
    const imgLeft = document.getElementById("img-left");
    const imgPlaceholderLeft = document.getElementById("img-placeholder-left");
    const btnLeft = document.getElementById("btn-left");

    const nameRight = document.getElementById("name-right");
    const idRight = document.getElementById("id-right");
    const imgRight = document.getElementById("img-right");
    const imgPlaceholderRight = document.getElementById("img-placeholder-right");
    const btnRight = document.getElementById("btn-right");

    // Click the sprite itself to play that Pok√©mon's cry
    imgLeft.style.cursor = "pointer";
    imgRight.style.cursor = "pointer";

    imgLeft.addEventListener("click", (e) => {
      const idx = parseInt(imgLeft.dataset.entryIndex, 10);
      if (!Number.isFinite(idx)) return;
      playCryForEntry(allEntries[idx]);
    });

    imgRight.addEventListener("click", (e) => {
      const idx = parseInt(imgRight.dataset.entryIndex, 10);
      if (!Number.isFinite(idx)) return;
      playCryForEntry(allEntries[idx]);
    });

    const bulbaLeft = document.getElementById("bulba-left");
    const bulbaRight = document.getElementById("bulba-right");

    const rankingUl = document.getElementById("ranking-ul");
    const favoriteLine = document.getElementById("favorite-line");
    const logBox = document.getElementById("log-box");

    const fullRankingGrid = document.getElementById("full-ranking-grid");
    const secondaryRankingGrid = document.getElementById("secondary-ranking-grid");

    // --- HELPERS ---

    function niceName(raw) {
      let name = raw.replace(/-/g, " ");
      if (raw === "nidoran-f") name = "nidoran‚ôÄ";
      if (raw === "nidoran-m") name = "nidoran‚ôÇ";
      return name;
    }

    function fullDisplayName(entry) {
      if (entry.displayName) return entry.displayName;
      return niceName(entry.pokemonName);
    }

    
    function bulbapediaUrlForEntry(entry) {
      // Use Bulbapedia's search so forms still resolve nicely,
      // but default to the base species page unless overridden.
      if (!entry) return "#";

      // 1) Explicit override wins (works for base entries and forms)
      let q = (entry.nameOverride && String(entry.nameOverride).trim()) ? String(entry.nameOverride) : "";

      // 2) If this is a form and no override, use the base species' pokemonName (dexId match)
      if (!q && entry.isForm && typeof allEntries !== "undefined" && Array.isArray(allEntries)) {
        const base = allEntries.find((e) => e && e.dexId === entry.dexId && !e.isForm);
        if (base && base.pokemonName) q = base.pokemonName;
      }

      // 3) Fallback: whatever is displayed
      if (!q) q = fullDisplayName(entry);

      // Strip anything in parentheses (forms, plumage, cloaks, etc.)
      q = q.replace(/\s*\([^)]*\)\s*/g, "");

      // Normalize formatting (hyphens -> spaces, etc.)
      q = niceName(q.trim());

      return "https://bulbapedia.bulbagarden.net/wiki/Special:Search?search=" + encodeURIComponent(q);
    }


    // --- Pok√©mon cry playback (click the sprite) ---
    const cryAudio = new Audio();
    cryAudio.preload = "none";
    const cryUrlCache = new Map(); // pokemonName -> url (or null)

    async function getCryUrl(pokemonName) {
      if (!pokemonName) return null;
      if (cryUrlCache.has(pokemonName)) return cryUrlCache.get(pokemonName);

      try {
        const res = await fetch("https://pokeapi.co/api/v2/pokemon/" + encodeURIComponent(pokemonName));
        if (!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();
        const url =
          (data.cries && (data.cries.latest || data.cries.legacy)) ||
          null;

        cryUrlCache.set(pokemonName, url);
        return url;
      } catch (err) {
        console.warn("Failed to load cry for", pokemonName, err);
        cryUrlCache.set(pokemonName, null);
        return null;
      }
    }

    async function playCryForEntry(entry) {
      if (!entry) return;
      const url = await getCryUrl(entry.pokemonName);
      if (!url) return;

      try {
        cryAudio.pause();
        cryAudio.currentTime = 0;
        cryAudio.src = url;

        // Match the slider volume (same one used for music)
        const vol = parseInt(volumeSlider.value, 10);
        cryAudio.volume = Number.isFinite(vol) ? Math.max(0, Math.min(1, vol / 100)) : 0.5;

        await cryAudio.play();
      } catch (err) {
        // Autoplay restrictions can block this sometimes; user click should usually allow it.
        console.warn("Cry playback failed:", err);
      }
    }

function log(message) {
      const p = document.createElement("p");
      p.textContent = message;
      logBox.appendChild(p);
      logBox.scrollTop = logBox.scrollHeight;
    }

    async function getPokemonInfo(pokemonName, overrideSpriteUrl = null) {
      const cached = pokemonInfoCache[pokemonName];
      if (cached) {
        // If a sprite override is requested, return a copy with that sprite
        if (overrideSpriteUrl) {
          return { ...cached, sprite: overrideSpriteUrl };
        }
        return cached;
      }

      let sprite = null;
      let primaryType = "normal";
      let secondaryType = null;

      try {
        const res = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonName}`);
        if (!res.ok) throw new Error("Not found");

        const data = await res.json();

        const id = data.id;
        const pokeosSprite =
          `https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/${id}.png`;

        sprite = overrideSpriteUrl || pokeosSprite;

        primaryType = data.types[0].type.name;
        secondaryType = data.types[1]?.type.name || null;
      } catch (err) {
        console.error("Error loading:", pokemonName, err);
        sprite = overrideSpriteUrl || "";
      }

      const info = { sprite, primaryType, secondaryType };
      pokemonInfoCache[pokemonName] = info;
      return info;
    }



    function updateRankingUI() {
      // Side panel top-15
      rankingUl.innerHTML = "";

      if (ranking.length === 0) {
        const li = document.createElement("li");
        const spanNum = document.createElement("span");
        spanNum.className = "rank-num";
        spanNum.textContent = "‚Äì";
        const spanName = document.createElement("span");
        spanName.className = "rank-name";
        spanName.textContent = "No Pok√©mon ranked yet.";
        li.appendChild(spanNum);
        li.appendChild(spanName);
        rankingUl.appendChild(li);

        favoriteLine.textContent = "";

        // Full grid placeholder
        fullRankingGrid.innerHTML = "";
        const emptyDiv = document.createElement("div");
        emptyDiv.className = "full-ranking-empty";
        emptyDiv.textContent = "No Pok√©mon ranked yet.";
        fullRankingGrid.appendChild(emptyDiv);

const emptyDiv2 = document.createElement("div");
        emptyDiv2.className = "full-ranking-empty";
        emptyDiv2.textContent = "Nothing here yet.";
        return;
      }

      const topDisplay = ranking.slice(0, 15);

      // Compute displayed rank numbers that respect adjacent tie blocks.
      function displayedRankForPos(pos) {
        let rankNum = 0;
        let prevKey = null;
        for (let p = 0; p <= pos && p < ranking.length; p++) {
          const eIdx = ranking[p];
          const g = getGroupIdForEntry(eIdx);
          const key = g ? ("g:" + g) : ("u:" + eIdx);
          if (p === 0) {
            rankNum = 1;
          } else if (key !== prevKey) {
            rankNum++;
          }
          prevKey = key;
        }
        return rankNum;
      }
      topDisplay.forEach((entryIndex, i) => {
        const entry = allEntries[entryIndex];
        const li = document.createElement("li");

        const spanNum = document.createElement("span");
        spanNum.className = "rank-num";
        spanNum.textContent = "#" + displayedRankForPos(i);

        const spanName = document.createElement("span");
        spanName.className = "rank-name";
        spanName.textContent = fullDisplayName(entry);

        const spanId = document.createElement("span");
        spanId.className = "rank-id";
        spanId.textContent = "No." + entry.dexId;

        li.appendChild(spanNum);
        li.appendChild(spanName);
        li.appendChild(spanId);
        rankingUl.appendChild(li);
      });

      const top = allEntries[ranking[0]];
      favoriteLine.textContent =
        "Current #1: " + fullDisplayName(top) + " (No." + top.dexId + ")";

      // Full Pok√© Ball grid
      fullRankingGrid.innerHTML = "";
      ranking.forEach((entryIndex, i) => {
        const entry = allEntries[entryIndex];

        const tile = document.createElement("div");
        tile.className = "ball-tile";
        tile.title =
          "#" + displayedRankForPos(i) +
          " ‚Äì " +
          fullDisplayName(entry) +
          " (No." +
          entry.dexId +
          ")";

        const shell = document.createElement("div");
        shell.className = "ball-shell";

        // Form rings: mega / gmax / regional
        let ringKind = entry.formKind || null;
        if (!ringKind && entry.isForm) {
          if (/alola|galar|hisui|paldea/i.test(entry.pokemonName)) {
            ringKind = "regional";
            
          }
        }
        if (ringKind === "mega") {
          shell.classList.add("mega-ring");
        } else if (ringKind === "gmax") {
          shell.classList.add("gmax-ring");
        } else if (ringKind === "regional") {
            shell.classList.add("regional-ring");  // keep the purple outer ring
            const badge = document.createElement("div");
            badge.className = "form-badge regional-badge";

            let iconUrl = null;

            // 1Ô∏è‚É£ Region override always wins
            if (entry.regionOverride) {
              switch (entry.regionOverride.toLowerCase()) {
                case "alola": iconUrl = ALOLA_ICON_URL; break;
                case "galar": iconUrl = GALAR_ICON_URL; break;
                case "hisui": iconUrl = HISUI_ICON_URL; break;
                case "paldea": iconUrl = PALDEA_ICON_URL; break;
              }
            }

            // 2Ô∏è‚É£ Otherwise detect from the name
            if (!iconUrl) {
              if (/alola/i.test(entry.pokemonName)) iconUrl = ALOLA_ICON_URL;
              else if (/galar/i.test(entry.pokemonName)) iconUrl = GALAR_ICON_URL;
              else if (/hisui/i.test(entry.pokemonName)) iconUrl = HISUI_ICON_URL;
              else if (/paldea/i.test(entry.pokemonName)) iconUrl = PALDEA_ICON_URL;
            }


            if (iconUrl) {
                const icon = document.createElement("img");
                icon.className = "form-badge-icon";
                icon.src = iconUrl;
                badge.appendChild(icon);
            } else {
                badge.textContent = "R"; // fallback text
            }

            shell.appendChild(badge);
        }else if (ringKind === "variant") {
          shell.classList.add("variant-ring");
        }else if (ringKind === "special") {
          shell.classList.add("special-ring");
        }

        const center = document.createElement("div");
        center.className = "ball-center";
        shell.appendChild(center);

        const img = document.createElement("img");
        img.className = "ball-sprite";
        img.style.display = "none";
        shell.appendChild(img);

        // Form badges (bottom-right) using images if provided, otherwise letters
        if (ringKind === "mega") {
          const badge = document.createElement("div");
          badge.className = "form-badge mega-badge";
          if (MEGA_ICON_URL) {
            const icon = document.createElement("img");
            icon.className = "form-badge-icon";
            icon.src = MEGA_ICON_URL;
            icon.alt = "Mega form";
            badge.appendChild(icon);
          } else {
            badge.textContent = "M";
          }
          shell.appendChild(badge);
        } else if (ringKind === "gmax") {
          const badge = document.createElement("div");
          badge.className = "form-badge gmax-badge";
          if (GMAX_ICON_URL) {
            const icon = document.createElement("img");
            icon.className = "form-badge-icon";
            icon.src = GMAX_ICON_URL;
            icon.alt = "G-Max form";
            badge.appendChild(icon);
          } else {
            badge.textContent = "Gx";
          }
          shell.appendChild(badge);
        }

        // Fetch type + sprite info and color the ball
        getPokemonInfo(entry.pokemonName).then((info) => {
            // Prefer manual overrides if present
            const primaryType =
                entry.primaryTypeOverride || info.primaryType;
            const secondaryType =
                entry.secondaryTypeOverride !== undefined
                ? entry.secondaryTypeOverride
                : info.secondaryType;

            const primaryColor =
                TYPE_COLORS[primaryType] || "#ef4444";
            const secondaryColor =
                TYPE_COLORS[secondaryType] || primaryColor;


          shell.style.background =
            "linear-gradient(to bottom," +
            primaryColor +
            " 0%," +
            primaryColor +
            " 48%,#111827 48%,#111827 52%," +
            secondaryColor +
            " 52%," +
            secondaryColor +
            " 100%)";

            const spriteUrl = entry.spriteOverride || info.sprite;

            if (spriteUrl) {
                img.src = spriteUrl;
                img.style.display = "block";
            } else {
                img.style.display = "none";
            }
        });

        const rankLabel = document.createElement("div");
        rankLabel.className = "ball-rank";
        rankLabel.textContent = "#" + displayedRankForPos(i);

        tile.appendChild(shell);
        tile.appendChild(rankLabel);
        fullRankingGrid.appendChild(tile);
      });

      // Secondary grid (Custom Pok√©dex): start with the highest-ranked Grass starter family
      updateSecondaryRankingGrid(displayedRankForPos);
    }

    // Build the secondary grid by selecting a "seed" family from the main ranking.
    // Current rule: pick the first (highest-ranked) member of ANY Grass starter family,
    // then show that whole family (including any forms) in Dex order.
    function updateSecondaryRankingGrid(displayedRankForPos) {
      if (!secondaryRankingGrid) return;


      // Curated Pok√©dex numbering: counts through the custom grid in display order.
      // Adjacent entries that share the same National Dex ID (e.g., regional forms placed next to each other)
      // share the same curated number.
      let curatedDexCounter = 0;
      let curatedLastDexId = null;
      const setCuratedDexCounter = (newValue) => {
        // Force the next displayed entry to start counting from (newValue + 1).
        curatedDexCounter = Math.max(0, Number(newValue) || 0);
        curatedLastDexId = null;
      };
      const nextCuratedDexLabel = (entry) => {
        const dexId = entry?.dexId;
        if (dexId == null) return "";
        if (dexId !== curatedLastDexId) {
          curatedDexCounter += 1;
          curatedLastDexId = dexId;
        }
        return "#" + String(curatedDexCounter).padStart(3, "0");
      };

      // Starter families (National Dex IDs)
      const STARTER_FAMILIES = {
        grass: [
          [1, 2, 3],       // Bulbasaur
          [152, 153, 154], // Chikorita
          [252, 253, 254], // Treecko
          [387, 388, 389], // Turtwig
          [495, 496, 497], // Snivy
          [650, 651, 652], // Chespin
          [722, 723, 724], // Rowlet
          [810, 811, 812], // Grookey
          [906, 907, 908], // Sprigatito
        ],
        fire: [
          [4, 5, 6],       // Charmander
          [155, 156, 157], // Cyndaquil
          [255, 256, 257], // Torchic
          [390, 391, 392], // Chimchar
          [498, 499, 500], // Tepig
          [653, 654, 655], // Fennekin
          [725, 726, 727], // Litten
          [813, 814, 815], // Scorbunny
          [909, 910, 911], // Fuecoco
        ],
        water: [
          [7, 8, 9],       // Squirtle
          [158, 159, 160], // Totodile
          [258, 259, 260], // Mudkip
          [393, 394, 395], // Piplup
          [501, 502, 503], // Oshawott
          [656, 657, 658], // Froakie
          [728, 729, 730], // Popplio
          [816, 817, 818], // Sobble
          [912, 913, 914], // Quaxly
        ],
      };

      // Early-game Bug lines (National Dex IDs). Used for the Custom Pok√©dex.
      // We select the highest-ranked member among these families and then display that whole family.
      const EARLY_BUG_FAMILIES = [
        [10, 11, 12],          // Caterpie -> Metapod -> Butterfree
        [13, 14, 15],          // Weedle -> Kakuna -> Beedrill
        [165, 166],            // Ledyba -> Ledian
        [167, 168],            // Spinarak -> Ariados
        [265, 266, 267, 268, 269], // Wurmple -> (Silcoon/Beautifly) and (Cascoon/Dustox)
        [401, 402],            // Kricketot -> Kricketune
        [540, 541, 542],       // Sewaddle -> Swadloon -> Leavanny
        [543, 544, 545],       // Venipede -> Whirlipede -> Scolipede
        [664, 665, 666],       // Scatterbug -> Spewpa -> Vivillon
        [736, 737, 738],       // Grubbin -> Charjabug -> Vikavolt
        [824, 825, 826],       // Blipbug -> Dottler -> Orbeetle
        [917, 918],            // Tarountula -> Spidops
        [919, 920],            // Nymble -> Lokix
      ];

      // Early-game Flying lines (National Dex IDs). Used for the Custom Pok√©dex.
      // We select the highest-ranked members among these families and then display those whole families.
      const EARLY_FLYING_FAMILIES = [
        [16, 17, 18],        // Pidgey -> Pidgeotto -> Pidgeot
        [21, 22],            // Spearow -> Fearow
        [163, 164],          // Hoothoot -> Noctowl
        [276, 277],          // Taillow -> Swellow
        [278, 279],          // Wingull -> Pelipper
        [396, 397, 398],     // Starly -> Staravia -> Staraptor
        [519, 520, 521],     // Pidove -> Tranquill -> Unfezant
        [661, 662, 663],     // Fletchling -> Fletchinder -> Talonflame
        [731, 732, 733],     // Pikipek -> Trumbeak -> Toucannon
        [821, 822, 823],     // Rookidee -> Corvisquire -> Corviknight
        [940, 941],          // Wattrel -> Kilowattrel
      ];

// Route 1 Normal lines (National Dex IDs). Used for the Custom Pok√©dex.
// We select the highest-ranked members among these families and then display those whole families.
const ROUTE_ONE_NORMAL_FAMILIES = [
  [19, 20],            // Rattata -> Raticate (includes regional forms via same Dex IDs)
  [161, 162],          // Sentret -> Furret
  [263, 264, 862],     // Zigzagoon -> Linoone -> Obstagoon
  [399, 400],          // Bidoof -> Bibarel
  [504, 505],          // Patrat -> Watchog
  [659, 660],          // Bunnelby -> Diggersby
  [734, 735],          // Yungoose -> Gumshoos
  [819, 820],          // Skwovet -> Greedent
  [915, 916],          // Lechonk -> Oinkologne
];

// Route 1 extra lines (National Dex IDs). Used for the Custom Pok√©dex.
// We select the highest-ranked member among these families and then display that whole family.
const ROUTE_ONE_EXTRA_FAMILIES = [
  [261, 262],          // Poochyena -> Mightyena
  [403, 404, 405],     // Shinx -> Luxio -> Luxray
  [509, 510],          // Purrloin -> Liepard
  [506, 507, 508],     // Lillipup -> Herdier -> Stoutland
  [827, 828],          // Nickit -> Thievul
  [831, 832],          // Wooloo -> Dubwool
];

	// Pseudo-legendary lines (National Dex IDs). Used for the Custom Pok√©dex.
	// We select the two highest-ranked pseudo-legendary families and display them right
	// before the legendary block. Their curated numbers must always be:
	//   1st pseudo line: #445, #446, #447
	//   2nd pseudo line: #448, #449, #450
	const PSEUDO_LEGENDARY_FAMILIES = [
	  [147, 148, 149],     // Dratini -> Dragonair -> Dragonite
	  [246, 247, 248],     // Larvitar -> Pupitar -> Tyranitar
	  [371, 372, 373],     // Bagon -> Shelgon -> Salamence
	  [374, 375, 376],     // Beldum -> Metang -> Metagross
	  [443, 444, 445],     // Gible -> Gabite -> Garchomp
	  [633, 634, 635],     // Deino -> Zweilous -> Hydreigon
	  [704, 705, 706],     // Goomy -> Sliggoo -> Goodra
	  [782, 783, 784],     // Jangmo-o -> Hakamo-o -> Kommo-o
	  [885, 886, 887],     // Dreepy -> Drakloak -> Dragapult
	  [996, 997, 998],     // Frigibax -> Arctibax -> Baxcalibur
	];

	const familyForPseudoLegendary = (dexId) => {
	  for (const fam of PSEUDO_LEGENDARY_FAMILIES) {
	    if (fam.includes(dexId)) return fam;
	  }
	  return null;
	};

const familyForRouteOneExtra = (dexId) => {
  for (const fam of ROUTE_ONE_EXTRA_FAMILIES) {
    if (fam.includes(dexId)) return fam;
  }
  return null;
};



      const familyForFlying = (dexId) => {
        for (const fam of EARLY_FLYING_FAMILIES) {
          if (fam.includes(dexId)) return fam;
        }
        return null;
      };

      const familyForBug = (dexId) => {
        for (const fam of EARLY_BUG_FAMILIES) {
          if (fam.includes(dexId)) return fam;
        }
        return null;
      };


const familyForRouteOneNormal = (dexId) => {
  for (const fam of ROUTE_ONE_NORMAL_FAMILIES) {
    if (fam.includes(dexId)) return fam;
  }
  return null;
};


      const familyForDex = (typeKey, dexId) => {
        const families = STARTER_FAMILIES[typeKey] || [];
        for (const fam of families) {
          if (fam.includes(dexId)) return fam;
        }
        return null;
      };

      // Helper: create a Pok√© Ball tile (same style as the main grid)
      const makeBallTile = (entry, labelText, titleText, curatedDexText = "") => {
        const tile = document.createElement("div");
        tile.className = "ball-tile";
        tile.title = titleText;

        const shell = document.createElement("div");
        shell.className = "ball-shell";

        let ringKind = entry.formKind || null;
        if (!ringKind && entry.isForm) {
          if (/alola|galar|hisui|paldea/i.test(entry.pokemonName)) {
            ringKind = "regional";
          }
        }
        if (ringKind === "mega") {
          shell.classList.add("mega-ring");
        } else if (ringKind === "gmax") {
          shell.classList.add("gmax-ring");
        } else if (ringKind === "regional") {
          shell.classList.add("regional-ring");
        } else if (ringKind === "variant") {
          shell.classList.add("variant-ring");
        } else if (ringKind === "special") {
          shell.classList.add("special-ring");
        }

        const center = document.createElement("div");
        center.className = "ball-center";
        shell.appendChild(center);

        const img = document.createElement("img");
        img.className = "ball-sprite";
        img.style.display = "none";
        shell.appendChild(img);

        // Type + sprite coloring
        getPokemonInfo(entry.pokemonName).then((info) => {
          const primaryType = entry.primaryTypeOverride || info.primaryType;
          const secondaryType =
            entry.secondaryTypeOverride !== undefined
              ? entry.secondaryTypeOverride
              : info.secondaryType;

          const primaryColor = TYPE_COLORS[primaryType] || "#ef4444";
          const secondaryColor = TYPE_COLORS[secondaryType] || primaryColor;

          shell.style.background =
            "linear-gradient(to bottom," +
            primaryColor +
            " 0%," +
            primaryColor +
            " 48%,#111827 48%,#111827 52%," +
            secondaryColor +
            " 52%," +
            secondaryColor +
            " 100%)";

          const spriteUrl = entry.spriteOverride || info.sprite;
          if (spriteUrl) {
            img.src = spriteUrl;
            img.style.display = "block";
          } else {
            img.style.display = "none";
          }
        });

        // label under ball (hidden by CSS for this grid)
        const label = document.createElement("div");
        label.className = "ball-rank";
        label.textContent = labelText;

        

        // Curated Pok√©dex number (only shown when provided)
        const curated = document.createElement("div");
        curated.className = "curated-dex";
        curated.textContent = curatedDexText || "";
        if (!curatedDexText) {
          curated.style.display = "none";
        }

        tile.appendChild(shell);
        tile.appendChild(label);
        tile.appendChild(curated);
        return tile;

      };

      const appendTopFamilyForType = (typeKey) => {
        // Find best-ranked member of this starter set, then expand to its whole family
        let chosenFamily = null;

        for (const entryIndex of ranking) {
          const dexId = allEntries[entryIndex]?.dexId;
          const fam = familyForDex(typeKey, dexId);
          if (fam) {
            chosenFamily = fam;
            break;
          }
        }

        if (!chosenFamily) return false;

        // Pull every entry whose Dex ID is in the chosen family
        const familyEntries = allEntries
          .map((e, idx) => ({ e, idx }))
          .filter(({ e }) => chosenFamily.includes(e.dexId));

        // Sort: Dex order first, then base species before forms, then name
        familyEntries.sort((a, b) => {
          if (a.e.dexId !== b.e.dexId) return a.e.dexId - b.e.dexId;
          const aIsForm = !!a.e.isForm;
          const bIsForm = !!b.e.isForm;
          if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
          return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
        });

        familyEntries.forEach(({ e, idx }) => {
          // Secondary grid rule: no Megas or G-Max forms
          if (e.formKind === "mega" || e.formKind === "gmax") return;

          const pos = ranking.indexOf(idx);
          const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
          const titleText =
            (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
            fullDisplayName(e) +
            " (No." +
            e.dexId +
            ")";
          const curatedLabel = nextCuratedDexLabel(e);
          const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
          secondaryRankingGrid.appendChild(tile);
        });

        return true;
      };

      // Append up to N early-route Bug families (distinct families).
      // Example: if Ledyba/Ledian is the top bug family, the next one cannot be that same family.
      const appendTopEarlyBugFamilies = (count) => {
        const chosenFamilies = [];
        const excludedDexIds = new Set();

        // Pick families in ranking order, skipping any already chosen.
        for (const entryIndex of ranking) {
          const dexId = allEntries[entryIndex]?.dexId;
          const fam = familyForBug(dexId);
          if (!fam) continue;

          // Skip if this family overlaps something already chosen
          if (fam.some((id) => excludedDexIds.has(id))) continue;

          chosenFamilies.push(fam);
          fam.forEach((id) => excludedDexIds.add(id));

          if (chosenFamilies.length >= count) break;
        }

        if (chosenFamilies.length === 0) return false;

        const renderFamily = (chosenFamily) => {
          const familyEntries = allEntries
            .map((e, idx) => ({ e, idx }))
            .filter(({ e }) => chosenFamily.includes(e.dexId));

          // Sort: Dex order first, then base species before forms, then name
          familyEntries.sort((a, b) => {
            if (a.e.dexId !== b.e.dexId) return a.e.dexId - b.e.dexId;
            const aIsForm = !!a.e.isForm;
            const bIsForm = !!b.e.isForm;
            if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
            return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
          });

          familyEntries.forEach(({ e, idx }) => {
            // Custom Pok√©dex rule: no Megas or G-Max forms
            if (e.formKind === "mega" || e.formKind === "gmax") return;

            const pos = ranking.indexOf(idx);
            const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
            const titleText =
              (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
              fullDisplayName(e) +
              " (No." +
              e.dexId +
              ")";
            const curatedLabel = nextCuratedDexLabel(e);
          const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
            secondaryRankingGrid.appendChild(tile);
          });
        };

        chosenFamilies.forEach(renderFamily);
        return true;
      };
      // Append up to N early-route Flying families (distinct families).
      // Example: if Pidgey/Pidgeotto/Pidgeot is the top flying family, the next one cannot be that same family.
      const appendTopEarlyFlyingFamilies = (count) => {
        const chosenFamilies = [];
        const excludedDexIds = new Set();

        // Pick families in ranking order, skipping any already chosen.
        for (const entryIndex of ranking) {
          const dexId = allEntries[entryIndex]?.dexId;
          if (!dexId) continue;
          if (excludedDexIds.has(dexId)) continue;

          const fam = familyForFlying(dexId);
          if (!fam) continue;

          // Skip if this family overlaps something already chosen
          if (fam.some((id) => excludedDexIds.has(id))) continue;

          chosenFamilies.push(fam);
          fam.forEach((id) => excludedDexIds.add(id));

          if (chosenFamilies.length >= count) break;
        }

        if (chosenFamilies.length === 0) return false;

        const renderFamily = (chosenFamily) => {
          const familyEntries = allEntries
            .map((e, idx) => ({ e, idx }))
            .filter(({ e }) => chosenFamily.includes(e.dexId));

          // Sort: Dex order first, then base species before forms, then name
          familyEntries.sort((a, b) => {
            if (a.e.dexId !== b.e.dexId) return a.e.dexId - b.e.dexId;
            const aIsForm = !!a.e.isForm;
            const bIsForm = !!b.e.isForm;
            if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
            return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
          });

          familyEntries.forEach(({ e, idx }) => {
            // Custom Pok√©dex rule: no Megas or G-Max forms
            if (e.formKind === "mega" || e.formKind === "gmax") return;

            const pos = ranking.indexOf(idx);
            const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
            const titleText =
              (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
              fullDisplayName(e) +
              " (No." +
              e.dexId +
              ")";
            const curatedLabel = nextCuratedDexLabel(e);
          const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
            secondaryRankingGrid.appendChild(tile);
          });
        };

        chosenFamilies.forEach(renderFamily);
        return true;
      };


// Append up to N Route 1 Normal families (distinct families).
// Example: if Rattata/Raticate is the top Route 1 normal family, the next one cannot be that same family.
const appendTopRouteOneNormalFamilies = (count) => {
  const chosenFamilies = [];
  const excludedDexIds = new Set();

  // Pick families in ranking order, skipping any already chosen.
  for (const entryIndex of ranking) {
    const dexId = allEntries[entryIndex]?.dexId;
    if (!dexId) continue;
    if (excludedDexIds.has(dexId)) continue;

    const fam = familyForRouteOneNormal(dexId);
    if (!fam) continue;

    // Skip if this family overlaps something already chosen
    if (fam.some((id) => excludedDexIds.has(id))) continue;

    chosenFamilies.push(fam);
    fam.forEach((id) => excludedDexIds.add(id));

    if (chosenFamilies.length >= count) break;
  }

  if (chosenFamilies.length === 0) return false;

  const renderFamily = (chosenFamily) => {
    const familyEntries = allEntries
      .map((e, idx) => ({ e, idx }))
      .filter(({ e }) => chosenFamily.includes(e.dexId));

    // Sort: Dex order first, then base species before forms, then name
    familyEntries.sort((a, b) => {
      if (a.e.dexId !== b.e.dexId) return a.e.dexId - b.e.dexId;
      const aIsForm = !!a.e.isForm;
      const bIsForm = !!b.e.isForm;
      if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
      return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
    });

    familyEntries.forEach(({ e, idx }) => {
      // Custom Pok√©dex rule: no Megas or G-Max forms
      if (e.formKind === "mega" || e.formKind === "gmax") return;

      const pos = ranking.indexOf(idx);
      const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
      const titleText =
        (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
        fullDisplayName(e) +
        " (No." +
        e.dexId +
        ")";
      const curatedLabel = nextCuratedDexLabel(e);
          const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
      secondaryRankingGrid.appendChild(tile);
    });
  };

  chosenFamilies.forEach(renderFamily);
  return true;
};

// Append up to N Route 1 extra families (distinct families).
// Example: if Shinx/Luxio/Luxray is the top extra family, the next one cannot be that same family.
const appendTopRouteOneExtraFamilies = (count) => {
  const chosenFamilies = [];
  const excludedDexIds = new Set();

  // Pick families in ranking order, skipping any already chosen.
  for (const entryIndex of ranking) {
    const dexId = allEntries[entryIndex]?.dexId;
    if (!dexId) continue;
    if (excludedDexIds.has(dexId)) continue;

    const fam = familyForRouteOneExtra(dexId);
    if (!fam) continue;

    // Skip if this family overlaps something already chosen
    if (fam.some((id) => excludedDexIds.has(id))) continue;

    chosenFamilies.push(fam);
    fam.forEach((id) => excludedDexIds.add(id));

    if (chosenFamilies.length >= count) break;
  }

  if (chosenFamilies.length === 0) return false;

  const renderFamily = (chosenFamily) => {
    const familyEntries = allEntries
      .map((e, idx) => ({ e, idx }))
      .filter(({ e }) => chosenFamily.includes(e.dexId));

    // Sort: Dex order first, then base species before forms, then name
    familyEntries.sort((a, b) => {
      if (a.e.dexId !== b.e.dexId) return a.e.dexId - b.e.dexId;
      const aIsForm = !!a.e.isForm;
      const bIsForm = !!b.e.isForm;
      if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
      return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
    });

    familyEntries.forEach(({ e, idx }) => {
      // Custom Pok√©dex rule: no Megas or G-Max forms
      if (e.formKind === "mega" || e.formKind === "gmax") return;

      const pos = ranking.indexOf(idx);
      const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
      const titleText =
        (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
        fullDisplayName(e) +
        " (No." +
        e.dexId +
        ")";
      const curatedLabel = nextCuratedDexLabel(e);
          const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
      secondaryRankingGrid.appendChild(tile);
    });
  };

  chosenFamilies.forEach(renderFamily);
  return true;
};

// Fill the middle of the Custom Pok√©dex (right after Route 1 Extra and before the pseudo-legendary block)
// using your ranked list, excluding: starters, early bugs, early birds, early route-1 normals, early extra,
// pseudo-legendary lines, and all legendary/mythical Pok√©mon. Also excludes Mega/G-Max forms by rule.
// Stops at curated dex #444 so the pseudo block can always start at #445.
const LEGENDARY_MYTHICAL_IDS = new Set([
  // Kanto
  144,145,146,150,151,
  // Johto
  243,244,245,249,250,251,
  // Hoenn
  377,378,379,380,381,382,383,384,385,386,
  // Sinnoh
  480,481,482,483,484,485,486,487,488,489,490,491,492,493,
  // Unova
  494,638,639,640,641,642,643,644,645,646,647,648,649,
  // Kalos
  716,717,718,719,720,721,
  // Alola
  785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,
  // Galar
  803,804,805,806,807,808,809,888,889,890,891,892,893,894,895,896,897,898,
  // Hisui
  899,900,901,902,903,904,905,
  // Paldea
  1001,1002,1003,1004,1005,1006,1007,1008,1014,1015,1016,1017,1020,1021,1022,1023,1024,1025
]);

const appendFillUntilPseudoStart = () => {
  const MAX_BEFORE_PSEUDO = 444;

  const excludedDexIds = new Set();

  const familyFromList = (familyList, dexId) => {
    for (const fam of familyList) {
      if (fam.includes(dexId)) return fam;
    }
    return null;
  };

  const addFamilyToExcluded = (fam) => {
    if (!fam) return;
    fam.forEach((id) => excludedDexIds.add(id));
  };

  // Exclude chosen starter families (grass/fire/water)
  ["grass","fire","water"].forEach((typeKey) => {
    let chosen = null;
    for (const entryIndex of ranking) {
      const dexId = allEntries[entryIndex]?.dexId;
      if (!dexId) continue;
      const fam = familyForDex(typeKey, dexId);
      if (fam) { chosen = fam; break; }
    }
    addFamilyToExcluded(chosen);
  });

  // Exclude early bug families (2), early flying families (2), route-1 normal families (2), route-1 extra (1)
  const pickTopFamilies = (familyList, count) => {
    const chosen = [];
    for (const entryIndex of ranking) {
      const dexId = allEntries[entryIndex]?.dexId;
      if (!dexId) continue;
      const fam = familyFromList(familyList, dexId);
      if (!fam) continue;
      if (chosen.some((f) => f === fam)) continue;
      // avoid overlaps
      if (fam.some((id) => excludedDexIds.has(id))) continue;
      chosen.push(fam);
      addFamilyToExcluded(fam);
      if (chosen.length >= count) break;
    }
  };

  pickTopFamilies(EARLY_BUG_FAMILIES, 2);
  pickTopFamilies(EARLY_FLYING_FAMILIES, 2);
  pickTopFamilies(ROUTE_ONE_NORMAL_FAMILIES, 2);
  pickTopFamilies(ROUTE_ONE_EXTRA_FAMILIES, 1);

  // Exclude all pseudo-legendary dex IDs so they don't appear in the fill section
  PSEUDO_LEGENDARY_FAMILIES.flat().forEach((id) => excludedDexIds.add(id));

  // Exclude all legendary & mythical dex IDs
  LEGENDARY_MYTHICAL_IDS.forEach((id) => excludedDexIds.add(id));

  let appendedAny = false;

  const wouldExceedMax = (entryDexId) => {
    const isNewDexId = entryDexId !== curatedLastDexId;
    const wouldBe = curatedDexCounter + (isNewDexId ? 1 : 0);
    return wouldBe > MAX_BEFORE_PSEUDO;
  };

  const renderDexIdGroup = (dexId) => {
    // Stop if adding this dexId would push us past #444
    if (wouldExceedMax(dexId)) return false;

    const groupEntries = allEntries
      .map((e, idx) => ({ e, idx }))
      .filter(({ e }) => e && e.dexId === dexId && e.formKind !== "mega" && e.formKind !== "gmax");

    // Sort: base species first, then forms, then name
    groupEntries.sort((a, b) => {
      const aIsForm = !!a.e.isForm;
      const bIsForm = !!b.e.isForm;
      if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
      return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
    });

    groupEntries.forEach(({ e, idx }) => {
      // Curated Pok√©dex rule: no Megas or G-Max forms (double safety)
      if (e.formKind === "mega" || e.formKind === "gmax") return;
      const pos = ranking.indexOf(idx);
      const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
      const titleText =
        (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
        fullDisplayName(e) +
        " (No." +
        e.dexId +
        ")";
      const curatedLabel = nextCuratedDexLabel(e);
      const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
      secondaryRankingGrid.appendChild(tile);
    });

    excludedDexIds.add(dexId);
    appendedAny = true;
    return true;
  };

  for (const entryIndex of ranking) {
    const e = allEntries[entryIndex];
    if (!e) continue;

    // Curated Pok√©dex rules
    if (e.formKind === "mega" || e.formKind === "gmax") continue;
    if (excludedDexIds.has(e.dexId)) continue;

    if (!renderDexIdGroup(e.dexId)) break; // either hit max or couldn't add
    if (curatedDexCounter >= MAX_BEFORE_PSEUDO) break;
  }

  return appendedAny;
};


	// Append the top pseudo-legendary families.
	// IMPORTANT: Their curated numbering must always be 445-450, regardless of how many entries
	// exist earlier in the curated grid.
	const appendTopPseudoLegendaryFamilies = (count) => {
	  const chosenFamilies = [];
	  const excludedDexIds = new Set();

	  // Pick families in ranking order, skipping any already chosen.
	  for (const entryIndex of ranking) {
	    const dexId = allEntries[entryIndex]?.dexId;
	    if (!dexId) continue;
	    if (excludedDexIds.has(dexId)) continue;

	    const fam = familyForPseudoLegendary(dexId);
	    if (!fam) continue;

	    // Skip if this family overlaps something already chosen
	    if (fam.some((id) => excludedDexIds.has(id))) continue;

	    chosenFamilies.push(fam);
	    fam.forEach((id) => excludedDexIds.add(id));

	    if (chosenFamilies.length >= count) break;
	  }

	  if (chosenFamilies.length === 0) return false;

	  // Force curated numbering to begin at #445 for the first pseudo line.
	  // (We set counter to 444 so the next new dexId becomes 445.)
	  setCuratedDexCounter(444);

	  const renderFamily = (chosenFamily) => {
	    const familyEntries = allEntries
	      .map((e, idx) => ({ e, idx }))
	      .filter(({ e }) => chosenFamily.includes(e.dexId));

	    // Sort: Dex order first, then base species before forms, then name
	    familyEntries.sort((a, b) => {
	      if (a.e.dexId !== b.e.dexId) return a.e.dexId - b.e.dexId;
	      const aIsForm = !!a.e.isForm;
	      const bIsForm = !!b.e.isForm;
	      if (aIsForm !== bIsForm) return aIsForm ? 1 : -1;
	      return fullDisplayName(a.e).localeCompare(fullDisplayName(b.e));
	    });

	    familyEntries.forEach(({ e, idx }) => {
	      // Custom Pok√©dex rule: no Megas or G-Max forms
	      if (e.formKind === "mega" || e.formKind === "gmax") return;

	      const pos = ranking.indexOf(idx);
	      const rankedLabel = pos >= 0 ? "#" + displayedRankForPos(pos) : "";
	      const titleText =
	        (pos >= 0 ? ("#" + displayedRankForPos(pos) + " ‚Äì ") : "") +
	        fullDisplayName(e) +
	        " (No." +
	        e.dexId +
	        ")";

	      const curatedLabel = nextCuratedDexLabel(e);
	      const tile = makeBallTile(e, rankedLabel, titleText, curatedLabel);
	      secondaryRankingGrid.appendChild(tile);
	    });
	  };

	  chosenFamilies.forEach(renderFamily);
	  return true;
	};



      secondaryRankingGrid.innerHTML = "";

      const foundGrass = appendTopFamilyForType("grass");
      const foundFire = appendTopFamilyForType("fire");
      const foundWater = appendTopFamilyForType("water");
      const foundEarlyBug = appendTopEarlyBugFamilies(2);
      const foundEarlyFlying = appendTopEarlyFlyingFamilies(2);
      const foundRouteOneNormal = appendTopRouteOneNormalFamilies(2);
      const foundRouteOneExtra = appendTopRouteOneExtraFamilies(1);
      const filledMiddle = appendFillUntilPseudoStart();
	      const foundPseudoLegendary = appendTopPseudoLegendaryFamilies(2);
	      if (!foundGrass && !foundFire && !foundWater && !foundEarlyBug && !foundEarlyFlying && !foundRouteOneNormal && !foundRouteOneExtra && !filledMiddle && !foundPseudoLegendary) {
        const emptyDiv = document.createElement("div");
        emptyDiv.className = "full-ranking-empty";
        emptyDiv.textContent =
	          "No starter, Route 1 normal, Route 1 extra, early-route Bug, early-route Flying, or pseudo-legendary families found in your ranking yet.";
        secondaryRankingGrid.appendChild(emptyDiv);
      }
    }

    function saveState() {
      const data = {
        ranking,
        currentInsertIndex,
        compareRankPos,
        mode,
        tieGroupByEntry,
        nextTieGroupId,
        actionHistory
      };
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      } catch (err) {
        console.error("Error saving state:", err);
      }
    }

    function clearState() {
      try {
        localStorage.removeItem(STORAGE_KEY);
      } catch (err) {
        console.error("Error clearing state:", err);
      }
    }

    async function fetchSpeciesListAndBuildEntries() {
      statusMain.textContent = "Loading Pok√©dex species from Pok√©API‚Ä¶";

      const url = "https://pokeapi.co/api/v2/pokemon-species?limit=10000&offset=0";

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();

        const speciesOnly = data.results
          .map((item) => {
            const match = item.url.match(/\/pokemon-species\/(\d+)\//);
            const id = match ? parseInt(match[1], 10) : null;
            return id ? { dexId: id, speciesName: item.name } : null;
          })
          .filter(Boolean)
          .filter((s) => s.dexId <= MAX_SPECIES_DEX_ID)
          .sort((a, b) => a.dexId - b.dexId);

        allEntries = [];
        for (const s of speciesOnly) {
          allEntries.push({
            dexId: s.dexId,
            pokemonName: s.speciesName,
            displayName: null,
            isForm: false,
            formKind: null
          });

          const extras = EXTRA_FORMS_CONFIG[s.dexId] || [];
          for (const f of extras) {
            allEntries.push({
              dexId: s.dexId,
              pokemonName: f.pokemonName,
              displayName: f.label,
              isForm: true,
              nameOverride: f.nameOverride || null,
              formKind: f.formKind || null,
              spriteOverride: f.spriteOverride || null,
              primaryTypeOverride: f.primaryTypeOverride,
              secondaryTypeOverride: f.secondaryTypeOverride,
              regionOverride: f.regionOverride || null
            });
          }
        }
        
        
        baseEntries = deepCopyEntries(allEntries);
        rebuildAllEntriesFromBase();
        await applyOrderingMode();

statusMain.textContent =
          "Pok√©dex loaded: " + allEntries.length + " entries (species + forms).";
        startBtn.disabled = false;
        resetBtn.disabled = false;
        musicBtn.disabled = false;

        await restoreStateIfExists();
      } catch (err) {
        console.error(err);
        statusMain.textContent = "Error loading Pok√©dex.";
      }
    }

    function initVolumeControl() {
        if (!bgm || !volumeSlider) return;

        // Load saved volume or default to 0.7 (70%)
        const saved = parseFloat(localStorage.getItem(VOLUME_KEY));
        const initialVolume = isNaN(saved) ? 0.7 : saved;

        bgm.volume = initialVolume;
        volumeSlider.value = Math.round(initialVolume * 100);

        // Update volume live as the slider moves
        volumeSlider.addEventListener("input", () => {
        const v = volumeSlider.value / 100; // 0.0‚Äì1.0
        bgm.volume = v;
        localStorage.setItem(VOLUME_KEY, v.toString());
        });
    }

    // Call this once after the DOM is ready and bgm is defined
    initVolumeControl();


    async function toggleMusic() {
        if (!bgm) return;

        if (!musicEnabled) {
            try {
                await bgm.play();
                musicEnabled = true;
                musicBtn.textContent = "Music: On";
            } catch (err) {
                console.error("Could not start music:", err);
                // If browser blocks autoplay, you might see an error here.
            }
        } else {
            bgm.pause();
            musicEnabled = false;
            musicBtn.textContent = "Music: Off";
        }
    }


    function setCardContent(side, entryIndex) {
      const entry = allEntries[entryIndex];
      const prettyName = fullDisplayName(entry);
      const dexId = entry.dexId;

      
      const bulbaUrl = bulbapediaUrlForEntry(entry);
      if (side === "left") {
        if (bulbaLeft) {
          bulbaLeft.href = bulbaUrl;
          bulbaLeft.title = "Open Bulbapedia for " + prettyName;
        }
      } else {
        if (bulbaRight) {
          bulbaRight.href = bulbaUrl;
          bulbaRight.title = "Open Bulbapedia for " + prettyName;
        }
      }

if (side === "left") {
        imgLeft.dataset.entryIndex = String(entryIndex);
        nameLeft.textContent = prettyName;
        idLeft.textContent = "No." + dexId;
        imgLeft.style.display = "none";
        imgPlaceholderLeft.style.display = "block";
        imgPlaceholderLeft.textContent = "Loading‚Ä¶";

        getPokemonInfo(entry.pokemonName, entry.spriteOverride).then((info) => {
          const ballEl = document.querySelector("#card-left .selection-ball");

          // Use overrides if present
          const primaryType = entry.primaryTypeOverride || info.primaryType;
          const secondaryType =
            entry.secondaryTypeOverride !== undefined
              ? entry.secondaryTypeOverride
              : info.secondaryType;

          const primaryColor = TYPE_COLORS[primaryType] || "#ef4444";
          const secondaryColor = TYPE_COLORS[secondaryType] || primaryColor;
    
          if (ballEl) {
            ballEl.style.background =
              "linear-gradient(to bottom," +
              primaryColor + " 0%," +
              primaryColor + " 48%,#111827 48%,#111827 52%," +
              secondaryColor + " 52%," +
              secondaryColor + " 100%)";
    
            ballEl.classList.remove(
              "mega-ring",
              "gmax-ring",
              "regional-ring",
              "variant-ring",
              "special-ring"
            );

            let ringKind = entry.formKind || null;
            if (!ringKind && entry.isForm) {
              if (/alola|galar|hisui|paldea/i.test(entry.pokemonName)) {
                ringKind = "regional";
              }
            }
            if (ringKind) {
              ballEl.classList.add(ringKind + "-ring");
            }
          }
    
          // ‚úÖ Prefer per-entry override
          const spriteUrl = entry.spriteOverride || info.sprite;
    
          if (spriteUrl) {
            imgLeft.src = spriteUrl;
            imgLeft.style.display = "block";
            imgPlaceholderLeft.style.display = "none";
          } else {
            imgLeft.style.display = "none";
            imgPlaceholderLeft.style.display = "block";
            imgPlaceholderLeft.textContent = "No image";
          }
        });

      } else {
        imgRight.dataset.entryIndex = String(entryIndex);
        nameRight.textContent = prettyName;
        idRight.textContent = "No." + dexId;
        imgRight.style.display = "none";
        imgPlaceholderRight.style.display = "block";
        imgPlaceholderRight.textContent = "Loading‚Ä¶";

        getPokemonInfo(entry.pokemonName, entry.spriteOverride).then((info) => {
          const ballEl = document.querySelector("#card-right .selection-ball");

          const primaryType = entry.primaryTypeOverride || info.primaryType;
          const secondaryType =
            entry.secondaryTypeOverride !== undefined
              ? entry.secondaryTypeOverride
              : info.secondaryType;
    
          const primaryColor = TYPE_COLORS[primaryType] || "#ef4444";
          const secondaryColor = TYPE_COLORS[secondaryType] || primaryColor;
    
          if (ballEl) {
            ballEl.style.background =
              "linear-gradient(to bottom," +
              primaryColor + " 0%," +
              primaryColor + " 48%,#111827 48%,#111827 52%," +
              secondaryColor + " 52%," +
              secondaryColor + " 100%)";

            ballEl.classList.remove(
              "mega-ring",
              "gmax-ring",
              "regional-ring",
              "variant-ring",
              "special-ring"
            );

            let ringKind = entry.formKind || null;
            if (!ringKind && entry.isForm) {
              if (/alola|galar|hisui|paldea/i.test(entry.pokemonName)) {
                ringKind = "regional";
              }
            }
            if (ringKind) {
              ballEl.classList.add(ringKind + "-ring");
            }
          }
    
          // ‚úÖ Prefer per-entry override
          const spriteUrl = entry.spriteOverride || info.sprite;

          if (spriteUrl) {
            imgRight.src = spriteUrl;
            imgRight.style.display = "block";
            imgPlaceholderRight.style.display = "none";
          } else {
            imgRight.style.display = "none";
            imgPlaceholderRight.style.display = "block";
            imgPlaceholderRight.textContent = "No image";
          }
        });
      }
    }


    function updateButtonsEnabled(enabled) {
      btnLeft.disabled = !enabled;
      btnRight.disabled = !enabled;
      tieBtn.disabled = !enabled;
      undoBtn.disabled = actionHistory.length === 0;
    }

    function updateInsertionStatusTexts() {
      const entry = allEntries[currentInsertIndex];
      statusMain.textContent =
        "Inserting " +
        fullDisplayName(entry) +
        " (No." +
        entry.dexId +
        ") into your list.";
      const lastDex = allEntries[allEntries.length - 1].dexId;
    }

    function askUnownMode() {
      const choice = confirm(
        "Do you want to rank ALL Unown forms?\n\n" +
        "OK = Shows all Unown letters\n" +
        "CANCEL = Only shows Unown A"
      );
      singleUnownMode = !choice;
    }

    function askCastformMode() {
      const choice = confirm(
        "Do you want to rank ALL Castform forms?\n\n" +
        "OK = Shows all Castform weathers\n" +
        "CANCEL = Only shows base Castform"
      );
      singleCastformMode = !choice;
    }

    function askDeoxysMode() {
      const choice = confirm(
        "Do you want to rank ALL Deoxys forms?\n\n" +
        "OK = Shows all Deoxys forms\n" +
        "CANCEL = Only shows Deoxys normal form"
      );
      singleDeoxysMode = !choice;
    }

    function askBurmyMode() {
      const choice = confirm(
        "Do you want to rank ALL Burmy cloaks?\n\n" +
        "OK = Show all Burmy cloaks\n" +
        "CANCEL = Only Show Burmy Plant Cloak"
      );
      singleBurmyMode = !choice;
    }

    function askWormadamMode() {
      const choice = confirm(
        "Do you want to rank ALL Wormadam cloaks?\n\n" +
        "OK = Show all Wormadam cloaks\n" +
        "CANCEL = Only Show Wormadam Plant Cloak"
      );
      singleWormadamMode = !choice;
    }

    function askRotomMode() {
      const choice = confirm(
        "Do you want to rank ALL Rotom Appliance Forms?\n\n" +
        "OK = Show all appliance forms of Rotom\n" +
        "CANCEL = Only show base form Rotom"
      );
      singleRotomMode = !choice;
    }

    function askArceusMode() {
      const choice = confirm(
        "Do you want to rank ALL Arceus typing?\n\n" +
        "OK = Show all types of Arceus\n" +
        "CANCEL = Only show normal type Arceus"
      );
      singleArceusMode = !choice;
    }

    function askDeerlingSawsbuckMode() {
      const choice = confirm(
        "Do you want to rank All seasons of Deerling and Sawsbuck?\n\n" +
        "OK = Show all Deerling and Sawsbuck seasons\n" +
        "CANCEL = Only show spring Deerling and Sawsbuck"
      );
      singleDeerlingSawsbuckMode = !choice;
    }

    function askGenesectMode() {
      const choice = confirm(
        "Do you want to rank All Genesect Drives?\n\n" +
        "OK = Show all drives\n" +
        "CANCEL = Show only no drive"
      );
      singleGenesectMode = !choice;
    }

    function askVivillonMode() {
      const choice = confirm(
        "Do you want to rank all Vivillon Patterns?\n\n" +
        "OK = Show all 20 Vivillon patterns\n" +
        "CANCEL = Show only meadow pattern Vivillon"
      );
      singleVivillonMode = !choice;
    }
    
    function askFlabebeFloetteFlorgesMode() {
      const choice = confirm(
        "Do you want to rank all flower colors of Flab√©b√©, Floette, and Florges?\n\n" +
        "OK = Show all flower colors of the entire evolution line\n" +
        "CANCEL = Red, blue, yellow, orange, and white flowers become just red(eternal flower remains seperate)"
      );
      singleFlabebeFloetteFlorgesMode = !choice;
    }

    function askFurFrouMode() {
      const choice = confirm(
        "Do you want to rank every Furfrou trim?\n\n" +
        "OK = Show all Trims\n" +
        "CANCEL = Show only untrimed Furfrou"
      );
      singleFurfrouMode = !choice;
    }

    function askPumpkabooGourgeistMode() {
      const choice = confirm(
        "Do you want to rank all sizes of Pumpkaboo and Gourgeist?\n\n" +
        "OK = Show all size\n" +
        "CANCEL = Only show average size"
      );
      singlePumpkabooGourgeistMode = !choice;
    }

    function askLycanrocMode() {
      const choice = confirm(
        "Do you want to rank all forms of Lycanroc?\n\n" +
        "OK = Show all forms\n" +
        "CANCEL = show only midday"
      );
      singleLycanrocMode = !choice;
    }

    function askSilvallyMode() {
      const choice = confirm(
        "Do you want to rank all types of Silvally?\n\n" +
        "OK = Show all types\n" +
        "CANCEL = show only normal"
      );
      singleSilvallyMode = !choice;
    }

    function askMiniorMode() {
      const choice = confirm(
        "Do you want to rank all core colors of Minior?\n\n" +
        "OK = Show all 7 core colors along with shield up\n" +
        "CANCEL = Show just shield up"
      );
      singleMiniorMode = !choice;
    }

    function askAlcremieMode() {
      const choice = confirm(
        "Do you want to rank all 70 creme and sweet variants of Alcremie\n\n" +
        "OK = Show all 70 creme and sweet variants\n" +
        "CANCEL = Only show one Alcremie variant"
      );
      singleAlcremieMode = !choice;
    }

    function askSquawkabillyMode() {
      const choice = confirm(
        "Do you want to rank all four colors of Squawkabilly?\n\n" +
        "OK = Show all four colors\n" +
        "CANCEL = Show only green"
      );
      singleSquawkabillyMode = !choice;
    }

    function askMegasMode() {
      const choice = confirm(
        "Do you want to include mega forms in the ranking?\n\n" +
        "OK = Show all megas from X, Y, Z-A base game, and Mega Dimension\n" +
        "CANCEL = Don't show any megas"
      )
      megasIncludedMode = choice;
    }

    function askGMaxMode() {
      const choice = confirm(
        "Do you want to include G-Max forms in the ranking?\n\n" +
        "OK = Show all megas from Sword, Shield, Isle of Armor, and Crown Tundra\n" +
        "CANCEL = Don't show any G-Max forms"
      )
      gMaxsIncludedMode = choice;
    }

    
    function askOrderingMode() {
      const msg =
        "Pick an ordering mode for the upcoming ranking:\n\n" +
        "1) National Pokedex Order\n" +
        "2) Ordered Families\n" +
        "3) Completely Random\n\n" +
        "Type 1, 2, or 3 and press OK.\n" +
        "(Cancel defaults to National Pokedex Order)";
      const ansRaw = prompt(msg, "1");
      const ans = (ansRaw || "").trim();
      if (ans === "2") orderingMode = "families";
      else if (ans === "3") orderingMode = "random";
      else orderingMode = "national";
    }

    function deepCopyEntries(arr) {
      if (typeof structuredClone === "function") return structuredClone(arr);
      return JSON.parse(JSON.stringify(arr));
    }

    function rebuildAllEntriesFromBase() {
      allEntries = deepCopyEntries(baseEntries);

if (singleUnownMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 201 && e.isForm));
        }
        if (singleCastformMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 351 && e.isForm));
        }
        if (singleDeoxysMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 386 && e.isForm));
        }
        if (singleBurmyMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 412 && e.isForm));
        }
        if (singleWormadamMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 413 && e.isForm));
        }
        if (singleRotomMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 479 && e.isForm));
        }
        if (singleArceusMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 493 && e.isForm));
        }
        if (singleDeerlingSawsbuckMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 585 && e.isForm));
          allEntries = allEntries.filter(e => !(e.dexId === 586 && e.isForm));
        }
        if (singleGenesectMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 649 && e.isForm));
        }
        if (singleVivillonMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 666 && e.isForm));
        }
        if (singleFlabebeFloetteFlorgesMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 669 && e.isForm));
          allEntries = allEntries.filter(e => {
            if (e.dexId !== 670) return true;
            if (!e.isForm) return true;
            if (e.formKind === "special" || e.formKind === "mega") return true;
            return false;
            });
          allEntries = allEntries.filter(e => !(e.dexId === 671 && e.isForm));
        }
        if (singleFurfrouMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 676 && e.isForm));
        }
        if (singlePumpkabooGourgeistMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 710 && e.isForm));
          allEntries = allEntries.filter(e => !(e.dexId === 711 && e.isForm));
        }
        if (singleLycanrocMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 745 && e.isForm));
        }
        if (singleSilvallyMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 773 && e.isForm));
        }
        if (singleMiniorMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 774 && e.isForm));
        }
        if (singleAlcremieMode) {
          allEntries = allEntries.filter(e => {
            if (e.dexId !== 869) return true;
            if (!e.isForm) return true;
            if (e.formKind === "gmax") return true;
            return false;
            });
        }
        if (singleSquawkabillyMode) {
          allEntries = allEntries.filter(e => !(e.dexId === 931 && e.isForm));
        }
        if (!megasIncludedMode) {
          allEntries = allEntries.filter(e => e.formKind !== "mega");
        }
        if (!gMaxsIncludedMode) {
          allEntries = allEntries.filter(e => e.formKind !== "gmax");
        }

        const unownEntry = allEntries.find(e => e.dexId === 201 && !e.isForm);
        if (unownEntry) {
            unownEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/201-a.png";
            if (!singleUnownMode) {
              unownEntry.displayName = "Unown (A)";
            } else {
              unownEntry.displayName = "Unown";
            }
        }
        const castformEntry = allEntries.find(e => e.dexId === 351 && !e.isForm);
        if (castformEntry) {
          castformEntry.pokemonName = "castform";
          castformEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/351.png";
          if (!singleCastformMode) {
            castformEntry.displayName = "Castform (Normal Form)";
          } else {
            castformEntry.displayName = "Castform";
          }
        }
        const deoxysEntry = allEntries.find(e => e.dexId === 386 && !e.isForm);
        if (deoxysEntry) {
            deoxysEntry.nameOverride= "Deoxys";
            deoxysEntry.pokemonName = "deoxys-normal";
            deoxysEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/386-normal.png";
            if (!singleDeoxysMode) {  
              deoxysEntry.displayName = "Deoxys (Normal Forme)";
            } else {
              deoxysEntry.displayName = "Deoxys";
            }
        }
        const burmyEntry = allEntries.find(e => e.dexId === 412 && !e.isForm);
        if (burmyEntry) {
            burmyEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/412-plant.png";
            if (!singleBurmyMode) {    
              burmyEntry.displayName = "Burmy (Plant Cloak)";
            } else {
              burmyEntry.displayName = "Burmy";
            }
        }
        const wormadamEntry = allEntries.find(e => e.dexId === 413 && !e.isForm);
        if (wormadamEntry) {
            wormadamEntry.pokemonName = "wormadam-plant";
            wormadamEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/413-plant.png";
            if (!singleWormadamMode) {
              wormadamEntry.displayName = "Wormadam (Plant Cloak)";
            } else {
              wormadamEntry.displayName = "Wormadam";
            }
        }
        const shellosEntry = allEntries.find(e => e.dexId === 422 && !e.isForm);
        if (shellosEntry) {
            shellosEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/422-west.png";
            shellosEntry.displayName = "Shellos (West Sea)";
        }
        const gastrodonEntry = allEntries.find(e => e.dexId === 423 && !e.isForm);
        if (gastrodonEntry) {
            gastrodonEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/423-west.png";
            gastrodonEntry.displayName = "Gastrodon (West Sea)";
        }
        const giratinaEntry = allEntries.find(e => e.dexId === 487 && !e.isForm);
        if (giratinaEntry) {
            giratinaEntry.pokemonName = "giratina-altered";
            giratinaEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/487-altered.png";
            giratinaEntry.displayName = "Giratina (Altered Forme)";
        }
        const shayminEntry = allEntries.find(e => e.dexId === 492 && !e.isForm);
        if (shayminEntry) {
            shayminEntry.pokemonName = "shaymin-land";
            shayminEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/492-land.png";
            shayminEntry.displayName = "Shaymin (Land Forme)";
        }
        const arceusEntry = allEntries.find(e => e.dexId === 493 && !e.isForm);
        if (arceusEntry) {
          if (!singleArceusMode) {
            arceusEntry.displayName = "Arceus (Normal Type)";
          } else {
            arceusEntry.displayName = "Arceus";
          }
        }
        const basculinEntry = allEntries.find(e => e.dexId === 550 && !e.isForm);
        if (basculinEntry) {
            basculinEntry.nameOverride = "Basculin"
            basculinEntry.pokemonName = "basculin-red-striped";
            basculinEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/550-red-striped.png";
            basculinEntry.displayName = "Red Stripe Basculin";
        }
        const darmanitanEntry = allEntries.find(e => e.dexId === 555 && !e.isForm);
        if (darmanitanEntry) {
            darmanitanEntry.pokemonName = "darmanitan-standard";
            darmanitanEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/555-standard.png";
            darmanitanEntry.displayName = "Darmanitan (Standard Mode)";
        }
        const deerlingEntry = allEntries.find(e => e.dexId === 585 && !e.isForm);
        if (deerlingEntry) {
            deerlingEntry.nameOverride = "Deerling";
            deerlingEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/585-spring.png";
          if (!singleDeerlingSawsbuckMode) {  
            deerlingEntry.displayName = "Spring Deerling";
          } else {
            deerlingEntry.displayName = "Deerling";
          }
        }
        const sawsbuckEntry = allEntries.find(e => e.dexId === 586 && !e.isForm);
        if (sawsbuckEntry) {
            sawsbuckEntry.nameOverride = "Sawsbuck";
            sawsbuckEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/586-spring.png";
            if (!singleDeerlingSawsbuckMode) {    
              sawsbuckEntry.displayName = "Spring Sawsbuck";
            } else {
              sawsbuckEntry.displayName = "Sawsbuck";
            }
        }
        const tornadusEntry = allEntries.find(e => e.dexId === 641 && !e.isForm);
        if (tornadusEntry) {
            tornadusEntry.pokemonName = "tornadus-incarnate";
            tornadusEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/641-incarnate.png";
            tornadusEntry.displayName = "Tornadus (Incarnate Forme)";
        }
        const thundurusEntry = allEntries.find(e => e.dexId === 642 && !e.isForm);
        if (thundurusEntry) {
            thundurusEntry.pokemonName = "thundurus-incarnate";
            thundurusEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/642-incarnate.png";
            thundurusEntry.displayName = "Thundurus (Incarnate Forme)";
        }
        const landorusEntry = allEntries.find(e => e.dexId === 645 && !e.isForm);
        if (landorusEntry) {
            landorusEntry.pokemonName = "landorus-incarnate";
            landorusEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/645-incarnate.png";
            landorusEntry.displayName = "Landorus (Incarnate Forme)";
        }
        const keldeoEntry = allEntries.find(e => e.dexId === 647 && !e.isForm);
        if (keldeoEntry) {
            keldeoEntry.pokemonName = "keldeo-ordinary";
            keldeoEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/647-ordinary.png";
            keldeoEntry.displayName = "Keldeo (Ordinary Forme)";
        }
        const meloettaEntry = allEntries.find(e => e.dexId === 648 && !e.isForm);
        if (meloettaEntry) {
            meloettaEntry.pokemonName = "meloetta-aria";
            meloettaEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/648-aria.png";
            meloettaEntry.displayName = "Meloetta (Aria Forme)";
        }
        const genesectEntry = allEntries.find(e => e.dexId === 649 && !e.isForm);
        if (genesectEntry) {
            genesectEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/649.png";
            if (!singleGenesectMode) {    
              genesectEntry.displayName = "Genesect (Normal)";
            } else {
              genesectEntry.displayName = "Genesect";
            }
        }
        const vivillonEntry = allEntries.find(e => e.dexId === 666 && !e.isForm);
        if (vivillonEntry) {
            vivillonEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/666-meadow.png";
            if (!singleVivillonMode) {
              vivillonEntry.displayName = "Vivillon (Meadow Pattern)";
            } else {
              vivillonEntry.displayName = "Vivillon";
            }
        }
        const flabebeEntry = allEntries.find(e => e.dexId === 669 && !e.isForm);
        if (flabebeEntry) {
            flabebeEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/669-red.png";
            if (!singleFlabebeFloetteFlorgesMode) {
              flabebeEntry.displayName = "Flab√©b√© (Red Flower)";
            } else {
              flabebeEntry.displayName = "Flab√©b√©";
            }
        }
        const floetteEntry = allEntries.find(e => e.dexId === 670 && !e.isForm);
        if (floetteEntry) {
            floetteEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/670-red.png";
            if (!singleFlabebeFloetteFlorgesMode) {
              floetteEntry.displayName = "Floette (Red Flower)";
            } else {
              floetteEntry.displayName = "Floette";
            }
        }
        const florgesEntry = allEntries.find(e => e.dexId === 671 && !e.isForm);
        if (florgesEntry) {
            florgesEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/671-red.png";
            if (!singleFlabebeFloetteFlorgesMode) {
              florgesEntry.displayName = "Florges (Red Flower)";
            } else {
              florgesEntry.displayName = "Florges";
            }
        }
        const furfrouEntry = allEntries.find(e => e.dexId === 676 && !e.isForm);
        if (furfrouEntry) {
            furfrouEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/676-natural.png";
            if (!singleFurfrouMode) {
              furfrouEntry.displayName = "Furfrou (Natural Forme)";
            } else {
              furfrouEntry.displayName = "Furfrou";
            }
        }
        const meowsticEntry = allEntries.find(e => e.dexId === 678 && !e.isForm);
        if (meowsticEntry) {
            meowsticEntry.pokemonName = "meowstic-male";
            meowsticEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/678-male.png";
            meowsticEntry.displayName = "Meowstic (Male)";
        }
        const aegislashEntry = allEntries.find(e => e.dexId === 681 && !e.isForm);
        if (aegislashEntry) {
            aegislashEntry.pokemonName = "aegislash-shield";
            aegislashEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/681-shield.png";
            aegislashEntry.displayName = "Aegislash (Shield)";
        }
        const pumpkabooEntry = allEntries.find(e => e.dexId === 710 && !e.isForm);
        if (pumpkabooEntry) {
          pumpkabooEntry.nameOverride = "Pumpkaboo";
          if(!singlePumpkabooGourgeistMode) {
            pumpkabooEntry.pokemonName = "pumpkaboo-average";
            pumpkabooEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/710-average.png";
            pumpkabooEntry.displayName = "Pumpkaboo (Average Size)";
          } else {
            pumpkabooEntry.pokemonName = "pumpkaboo-average";
            pumpkabooEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/710-average.png";
            pumpkabooEntry.displayName = "Pumpkaboo";
            }
        }
        const gourgeistEntry = allEntries.find(e => e.dexId === 711 && !e.isForm);
        if (gourgeistEntry) {
          gourgeistEntry.nameOverride = "Gourgeist";
          if (!singlePumpkabooGourgeistMode) {
            gourgeistEntry.pokemonName = "gourgeist-average";
            gourgeistEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/711-average.png";
            gourgeistEntry.displayName = "Gourgeist (Average Size)";
          } else {
            gourgeistEntry.pokemonName = "gourgeist-average";
            gourgeistEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/711-average.png";
            gourgeistEntry.displayName = "Gourgeist";
          }
        }
        const zygardeEntry = allEntries.find(e => e.dexId === 718 && !e.isForm);
        if (zygardeEntry) {
            zygardeEntry.pokemonName = "zygarde-10";
            zygardeEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/718-10.png";
            zygardeEntry.displayName = "Zygarde (10% Forme)";
        }
        const oricorioEntry = allEntries.find(e => e.dexId === 741 && !e.isForm);
        if (oricorioEntry) {
            oricorioEntry.pokemonName = "oricorio-baile";
            oricorioEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/741-baile.png";
            oricorioEntry.displayName = "Oricorio (Baile Style)";
        }
        const lycanrocEntry = allEntries.find(e => e.dexId === 745 && !e.isForm);
        if (lycanrocEntry) {
            lycanrocEntry.pokemonName = "lycanroc-midday";
            lycanrocEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/745-midday.png";
            if (!singleLycanrocMode) {
              lycanrocEntry.displayName = "Lycanroc (Midday Forme)";
            } else {
              lycanrocEntry.displayName = "Lycanroc";
            }
        }
        const wishiwashiEntry = allEntries.find(e => e.dexId === 746 && !e.isForm);
        if (wishiwashiEntry) {
            wishiwashiEntry.pokemonName = "wishiwashi-solo";
            wishiwashiEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/746-solo.png";
            wishiwashiEntry.displayName = "Wishiwashi (Solo Forme)";
        }
        const silvallyEntry = allEntries.find(e => e.dexId === 773 && !e.isForm);
        if (silvallyEntry) {
            silvallyEntry.pokemonName = "silvally-normal";
            silvallyEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/773-normal.png";
            if (!singleSilvallyMode) {
              silvallyEntry.displayName = "Silvally (Normal Type)";
            } else {
              silvallyEntry.displayName = "Silvally";
            }
        }
        const miniorEntry = allEntries.find(e => e.dexId === 774 && !e.isForm);
        if (miniorEntry) {
            miniorEntry.pokemonName = "minior-red-meteor";
            miniorEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/774-meteor.png";
            if (!singleMiniorMode) {
              miniorEntry.displayName = "Minior (Meteor Forme)";
            } else {
              miniorEntry.displayName = "Minior";
            }
        }
        const mimikyuEntry = allEntries.find(e => e.dexId === 778 && !e.isForm);
        if (mimikyuEntry) {
            mimikyuEntry.pokemonName = "mimikyu-disguised";
            mimikyuEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/778-disguised.png";
            mimikyuEntry.displayName = "Mimikyu";
        }
        const toxtricityEntry = allEntries.find(e => e.dexId === 849 && !e.isForm);
        if (toxtricityEntry) {
            toxtricityEntry.pokemonName = "toxtricity-low-key";
            toxtricityEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/849-low-key.png";
            toxtricityEntry.displayName = "Toxtricity (Low Key Forme)";
        }
        const alcremieEntry = allEntries.find(e => e.dexId === 869 && !e.isForm);
        if (alcremieEntry) {
            alcremieEntry.pokemonName = "alcremie";
            alcremieEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/fallback/869-vanilla-cream-strawberry-sweet.png";
            if (!singleAlcremieMode) {
              alcremieEntry.displayName = "Alcremie (Vanilla Cream/Strawberry Sweet)";
            } else {
              alcremieEntry.displayName = "Alcremie";
            }
        }
        const eiscueEntry = allEntries.find(e => e.dexId === 875 && !e.isForm);
        if (eiscueEntry) {
            eiscueEntry.pokemonName = "eiscue-ice";
            eiscueEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/875-ice.png";
            eiscueEntry.displayName = "Eiscue (Ice Face)";
        }
        const indeedeeEntry = allEntries.find(e => e.dexId === 876 && !e.isForm);
        if (indeedeeEntry) {
            indeedeeEntry.pokemonName = "indeedee-male";
            indeedeeEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/876-male.png";
            indeedeeEntry.displayName = "Indeedee (Male)";
        }
        const morpekoEntry = allEntries.find(e => e.dexId === 877 && !e.isForm);
        if (morpekoEntry) {
            morpekoEntry.pokemonName = "morpeko-full-belly";
            morpekoEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/877-full-belly.png";
            morpekoEntry.displayName = "Morpeko (Full Belly)";
        }
        const zacianEntry = allEntries.find(e => e.dexId === 888 && !e.isForm);
        if (zacianEntry) {
            zacianEntry.nameOverride = "Zacian";
            zacianEntry.displayName = "Hero of Many Battles Zacian";
        }
        const zamazentaEntry = allEntries.find(e => e.dexId === 889 && !e.isForm);
        if (zamazentaEntry) {
            zamazentaEntry.nameOverride = "Zamazenta";
            zamazentaEntry.displayName = "Hero of Many Battles Zamazenta";
        }
        const urshifuEntry = allEntries.find(e => e.dexId === 892 && !e.isForm);
        if (urshifuEntry) {
            urshifuEntry.nameOverride = "Urshifu";
            urshifuEntry.pokemonName = "urshifu-single-strike";
            urshifuEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/892-single-strike.png";
            urshifuEntry.displayName = "Single Strike Urshifu";
        }
        const basculegionEntry = allEntries.find(e => e.dexId === 902 && !e.isForm);
        if (basculegionEntry) {
            basculegionEntry.nameOverride = "Basculegion";
            basculegionEntry.pokemonName = "basculegion-male";
            basculegionEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/902-male.png";
            basculegionEntry.displayName = "Basculegion (Male)";
        }
        const enamorusEntry = allEntries.find(e => e.dexId === 905 && !e.isForm);
        if (enamorusEntry) {
            enamorusEntry.pokemonName = "enamorus-incarnate";
            enamorusEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/905-incarnate.png";
            enamorusEntry.displayName = "Enamorus (Incarnate Forme)";
        }
        const oinkologneEntry = allEntries.find(e => e.dexId === 916 && !e.isForm);
        if (oinkologneEntry) {
            oinkologneEntry.pokemonName = "oinkologne-male";
            oinkologneEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/916-male.png";
            oinkologneEntry.displayName = "Oinkologne (Male)";
        }
        const mausholdEntry = allEntries.find(e => e.dexId === 925 && !e.isForm);
        if (mausholdEntry) {
            mausholdEntry.pokemonName = "maushold-family-of-three";
            mausholdEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/925-family-of-three.png";
            mausholdEntry.displayName = "Maushold (Family of Three)";
        }
        const squawkabillyEntry = allEntries.find(e => e.dexId === 931 && !e.isForm);
        if (squawkabillyEntry) {
            squawkabillyEntry.pokemonName = "squawkabilly-green-plumage"
            squawkabillyEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/931.png";
            if (!singleSquawkabillyMode) {
              squawkabillyEntry.displayName = "Squawkabilly (Green Plumage)";
            } else {
              squawkabillyEntry.displayName = "Squawkabilly"
            }
        }
        const palafinEntry = allEntries.find(e => e.dexId === 964 && !e.isForm);
        if (palafinEntry) {
            palafinEntry.pokemonName = "palafin-zero"
            palafinEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/964.png";
            palafinEntry.displayName = "Palafin (Zero Form)";
        }
        const tatsugiriEntry = allEntries.find(e => e.dexId === 978 && !e.isForm);
        if (tatsugiriEntry) {
            tatsugiriEntry.pokemonName = "tatsugiri-curly"
            tatsugiriEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/978-curly.png";
            tatsugiriEntry.displayName = "Tatsugiri (Curly Form)";
        }
        const dudunsparceEntry = allEntries.find(e => e.dexId === 982 && !e.isForm);
        if (dudunsparceEntry) {
            dudunsparceEntry.pokemonName = "dudunsparce-two-segment"
            dudunsparceEntry.spriteOverride =
        "https://s3.pokeos.com/pokeos-uploads/assets/pokemon/home/render/982-two-segment.png";
            dudunsparceEntry.displayName = "Dudunsparce (Two Segment)";
        }
        const gimmighoulEntry = allEntries.find(e => e.dexId === 999 && !e.isForm);
        if (gimmighoulEntry) {
          gimmighoulEntry.displayName = "Gimmighoul (Chest Form)"
        }
        const ogerponEntry = allEntries.find(e => e.dexId === 1017 && !e.isForm);
        if (ogerponEntry) {
          ogerponEntry.displayName = "Ogerpon (Teal Mask)"
        }
        const terapagosEntry = allEntries.find(e => e.dexId === 1024 && !e.isForm);
        if (terapagosEntry) {
          terapagosEntry.displayName = "Terapagos (Normal Form)"
        }

        
    }

    function shuffleInPlace(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        const tmp = arr[i];
        arr[i] = arr[j];
        arr[j] = tmp;
      }
    }

    async function applyOrderingMode() {
      if (!allEntries || allEntries.length === 0) return;

      const baseSort = (a, b) => {
        if (a.dexId !== b.dexId) return a.dexId - b.dexId;
        if (!!a.isForm !== !!b.isForm) return a.isForm ? 1 : -1;
        return 0;
      };

      if (orderingMode === "national") {
        allEntries.sort(baseSort);
        return;
      }

      if (orderingMode === "random") {
        shuffleInPlace(allEntries);
        return;
      }

      if (orderingMode === "staged") {
        const grass = new Set([1, 152, 252, 387, 495, 650, 722, 810, 906]);
        const grassA = new Set([2, 153, 253, 388, 496, 651, 723, 811, 907]);
        const grassB = new Set([3, 154, 254, 389, 497, 652, 724, 812, 908]);
        const fire  = new Set([4, 155, 255, 390, 498, 653, 725, 813, 909]);
        const fireA = new Set([5, 156, 256, 391, 499, 654, 726, 814, 910]);
        const fireB = new Set([6, 157, 257, 392, 500, 655, 727, 815, 911]);
        const water = new Set([7, 158, 258, 393, 501, 656, 728, 816, 912]);
        const waterA = new Set([8, 159, 259, 394, 502, 657, 729, 817, 913]);
        const waterB = new Set([9, 160, 260, 395, 503, 658, 730, 818, 914]);
        const routeOneBug = new Set([10, 13, 165, 167, 265, 401, 540, 543, 664, 736, 824, 917, 919]);
        const routeOneBugA = new Set([11, 14, 166, 168, 266, 268, 402, 541, 544, 665, 737, 825, 918, 920]);
        const routeOneBugB = new Set([12, 15, 267, 269, 542, 545, 666, 738, 826]);
        const routeOneBird = new Set([16, 21, 163, 276, 278, 396, 519, 661, 731, 821, 940]);
        const routeOneBirdA = new Set([17, 22, 164, 277, 279, 397, 520, 662, 732, 822, 941]);
        const routeOneBirdB = new Set([18, 398, 521, 663, 733, 823]);
        const routeOneNormal = new Set([19, 161, 263, 399, 504, 659, 734, 819, 915]);
        const routeOneNormalA = new Set([20, 162, 264, 400, 505, 660, 735, 820, 916]);
        const routeOneNormalB = new Set([862]);
        const routeOneOther = new Set([261, 403, 506, 509, 827, 831]);
        const routeOneOtherA = new Set([262, 404, 507, 510, 828, 832]);
        const routeOneOtherB = new Set([405, 508]);
        const pikaclones = new Set([172]);
        const pikaclonesA = new Set([25, 26, 311, 312, 417, 587, 702, 777, 778, 877, 921, 922, 923]);
        const eeveelutions = new Set([133, 134, 135, 136, 196, 197, 470, 471, 700]);
        const elementalMonkey = new Set([511, 513, 515]);
        const elementalMonkeyA = new Set([512, 514, 516]);
        const fossils = new Set([138, 140, 142, 345, 347, 408, 410, 564, 566, 696, 698, 880, 881, 882, 883]);
        const fossilsA = new Set([139, 141, 346, 348, 409, 411, 565, 567, 697, 699]);
        const convergent = new Set([948, 960, 1012]);
        const convergentA = new Set([949, 961, 1013]);
        const pseudoLegendary = new Set([147, 246, 371, 374, 443, 633, 704, 782, 885, 996]);
        const pseudoLegendaryA = new Set([148, 247, 372, 375, 444, 634, 705, 783, 886, 997]);
        const pseudoLegendaryB = new Set([149, 248, 373, 376, 445, 635, 706, 784, 887, 998]);
        const legendary = new Set([144, 145, 146, 150]);
        const mythical = new Set([151]);
        const legendaryA = new Set([243, 244, 245, 249, 250]);
        const mythicalA = new Set([251]);
        const legendaryB = new Set([377, 378, 379, 380, 381, 382, 383, 384]);
        const mythicalB = new Set([385, 386]);
        const legendaryC = new Set([480, 481, 482, 483, 484, 485, 486, 487, 488]);
        const mythicalC = new Set([489, 490, 491, 492, 493]);
        const legendaryD = new Set([638, 639, 640, 641, 642, 645, 643, 644, 646]);
        const mythicalD = new Set([494, 647, 648, 649]);
        const legendaryE = new Set([716, 717, 718]);
        const mythicalE = new Set([719, 720, 721]);
        const ultraBeast = new Set([793, 794, 795, 796, 797, 798, 799, 803, 804, 805, 806]);
        const legendaryF = new Set([772, 773, 785, 786, 787, 788, 789, 790, 791, 792, 800]);
        const mythicalF = new Set([801, 802, 807, 808, 809]);
        const legendaryG = new Set([888, 889, 890, 891, 892, 894, 895, 896, 897, 898]);
        const noblePokemon = new Set([58, 100, 123, 548, 712]);
        const noblePokemonA = new Set([59, 101, 212]);
        const noblePokemonB = new Set([900]);
        const noblePokemonC = new Set([549, 713]);
        const ridePokemon = new Set([215, 216, 234, 550, 627]);
        const ridePokemonA = new Set([461, 903]);
        const ridePokemonB = new Set([217, 899, 902]);
        const ridePokemonC = new Set([628, 901]);
        const mythicalG = new Set([893]);
        const legendaryH = new Set([905]);
        const pastParadox = new Set([984, 985, 986, 987, 988, 989, 1005, 1009, 1020, 1021]);
        const futureParadox = new Set([990, 991, 992, 993, 994, 995, 1006, 1010, 1022, 1023]);
        const legendaryI = new Set([1001, 1002, 1003, 1004, 1007, 1008, 1014, 1015, 1016, 1017, 1024]);
        const mythicalI = new Set([1025]);
        const megasXY = new Set([63, 92, 115, 127, 129, 179, 214, 228, 280, 303, 307, 309, 353, 359, 447, 459]);
        const megasXYA = new Set([64, 93, 130, 180, 229, 281, 308, 310, 354, 448, 460]);
        const megasXYB = new Set([65, 94, 181, 282, 475]);
        const megaORAS = new Set([79, 95, 302, 318, 322, 333, 361, 427, 531]);
        const megaORASA = new Set([80, 199, 208, 319, 323, 334, 362, 478]);
        const megaORASB = new Set([428]);
        const alolan = new Set([27, 37, 50, 52, 74, 88, 102, 104]);
        const alolanA = new Set([28, 38, 51, 53, 863]);
        const alolanB = new Set([75, 89, 103, 105]);
        const alolanC = new Set([76]);
        const galarian = new Set([77, 83, 109, 439]);
        const galarianA = new Set([222, 554, 562, 618]);
        const galarianB = new Set([78, 865]);
        const galarianC = new Set([110, 122, 864]);
        const galarianD = new Set([555, 563, 867]);
        const galarianE = new Set([866]);
        const gMax = new Set([66, 98, 131, 446, 568, 833, 837, 840, 843, 848, 850, 856, 859, 868, 878, 884]);
        const gMaxA = new Set([67, 99, 143, 569, 834, 838, 841, 842, 1011]);
        const gMaxB = new Set([844, 849, 851, 857, 860, 869, 879, 1018]);
        const gMaxC = new Set([68, 839, 1019]);
        const gMaxD = new Set([858, 861]);
        const hisuian = new Set([211, 570, 904]);
        const hisuianA = new Set([571]);
        const paldean = new Set([128, 194, 195, 980]);
        const paradoxInspire = new Set([231, 174, 590]);
        const paradoxInspireA = new Set([200, 636]);
        const paradoxInspireB = new Set([81, 225, 296, 967]);
        const paradoxInspireC = new Set([232]);
        const paradoxInspireD = new Set([39, 591]);
        const paradoxInspireE = new Set([429, 637]);
        const paradoxInspireF = new Set([82, 297]);
        const paradoxInspireG = new Set([40, 462]);
        const megasZA = new Set([173]);
        const megasZAA = new Set([69, 120, 227, 529, 543, 559, 602, 607, 667, 669, 686, 688, 690, 701, 780, 870]);
        const megasZAB = new Set([35, 70, 121, 530, 544, 560, 603, 608, 668, 670, 687, 689, 691]);
        const megasZAC = new Set([36, 71, 545, 604, 609, 671]);
        const megasMD = new Set([433, 622, 677, 739, 767, 951, 969, 978]);
        const megasMDA = new Set([358, 623, 678, 740, 768, 952, 970]);
        const rocket = new Set([23, 41, 43, 48, 96]);
        const rocketA = new Set([24, 42, 44, 49, 97]);
        const rocketB = new Set([196]);
        const rocketC = new Set([45, 182]);
        const magma = new Set([343, 344]);
        const aqua = new Set([320, 321]);
        const galactic = new Set([198, 431, 434, 436, 453]);
        const galacticA = new Set([430, 432, 435, 437, 454]);
        const plasma = new Set([336, 451, 551, 624]);
        const plasmaA = new Set([452, 552, 625]);
        const plasmaB = new Set([553, 983]);
        const flare = new Set([316, 317]);
        const skull = new Set([747, 753, 757]);
        const skullA = new Set([748, 754, 758]);
        const rainbowRocket = new Set([56, 72]);
        const rainbowRocketA = new Set([57, 73]);
        const rainbowRocketB = new Set([979]);
        const yell = new Set([674, 675]);
        const star = new Set([944, 945]);
        const erikaRB = new Set([114, 465]);
        const giovanniRB = new Set([29, 32, 111]);
        const giovanniRBA = new Set([30, 33, 112]);
        const giovanniRBB = new Set([31, 34, 464]);
        const loreleiRB = new Set([86, 90, 238]);
        const loreleiRBA = new Set([87, 91, 124]);
        const brunoRB = new Set([236]);
        const brunoRBA = new Set([106, 107, 237]);
        const whitneyGS = new Set([241]);
        const chuckGS = new Set([60, 61, 62, 186]);
        const pryceGS = new Set([220, 221, 473]);
        const clairGS = new Set([116, 117, 230]);
        const mistyGS = new Set([54, 55]);
        const surgeGS = new Set([239]);
        const surgeGSA = new Set([125, 466]);
        const erikaGS = new Set([187, 188, 189]);
        const blaineGS = new Set([218, 240]);
        const blaineGSA = new Set([219]);
        const blaineGSB = new Set([126, 467]);
        const willGS = new Set([177, 178]);
        const kogaGS = new Set([204, 205]);
        const roxanneRS = new Set([299, 476]);
        const flanneryRS = new Set([324]);
        const normanRS = new Set([287, 288, 289]);
        const tateLizaRS = new Set([337, 338]);
        const wallaceRS = new Set([118, 339, 349, 363, 370]);
        const wallaceRSA = new Set([119, 340, 350, 364, 365]);
        const sidneyRS = new Set([273, 331]);
        const sidneyRSA = new Set([274, 332]);
        const sidneyRSB = new Set([275]);
        const phoebeRS = new Set([355, 356, 477]);
        const drakeRS = new Set([328, 329, 330]);
        const normanE = new Set([327]);
        const juanE = new Set([341, 342]);
        const wallaceE = new Set([270, 271, 272]);

        const groupRank = (e) => {
          if (grass.has(e.dexId)) return 0;
          if (grassA.has(e.dexId)) return 1;
          if (grassB.has(e.dexId)) return 2;
          if (fire.has(e.dexId)) return 3;
          if (fireA.has(e.dexId)) return 4;
          if (fireB.has(e.dexId)) return 5;
          if (water.has(e.dexId)) return 6;
          if (waterA.has(e.dexId)) return 7;
          if (waterB.has(e.dexId)) return 8;
          if (routeOneBug.has(e.dexId)) return 9;
          if (routeOneBugA.has(e.dexId)) return 10;
          if (routeOneBugB.has(e.dexId)) return 11;
          if (routeOneBird.has(e.dexId)) return 12;
          if (routeOneBirdA.has(e.dexId)) return 13;
          if (routeOneBirdB.has(e.dexId)) return 14;
          if (routeOneNormal.has(e.dexId)) return 15;
          if (routeOneNormalA.has(e.dexId)) return 16;
          if (routeOneNormalB.has(e.dexId)) return 17;
          if (routeOneOther.has(e.dexId)) return 18;
          if (routeOneOtherA.has(e.dexId)) return 19;
          if (routeOneOtherB.has(e.dexId)) return 20;          
          if (pikaclones.has(e.dexId)) return 21;          
          if (pikaclonesA.has(e.dexId)) return 22;
          if (eeveelutions.has(e.dexId)) return 23;
          if (elementalMonkey.has(e.dexId)) return 24;
          if (elementalMonkeyA.has(e.dexId)) return 25;
          if (fossils.has(e.dexId)) return 26;
          if (fossilsA.has(e.dexId)) return 27;
          if (convergent.has(e.dexId)) return 28;
          if (convergentA.has(e.dexId)) return 29;
          if (pseudoLegendary.has(e.dexId)) return 30;
          if (pseudoLegendaryA.has(e.dexId)) return 31;
          if (pseudoLegendaryB.has(e.dexId)) return 32;
          if (legendary.has(e.dexId)) return 33;
          if (mythical.has(e.dexId)) return 34;
          if (legendaryA.has(e.dexId)) return 35;
          if (mythicalA.has(e.dexId)) return 36;
          if (legendaryB.has(e.dexId)) return 37;
          if (mythicalB.has(e.dexId)) return 38;
          if (legendaryC.has(e.dexId)) return 39;
          if (mythicalC.has(e.dexId)) return 40;
          if (legendaryD.has(e.dexId)) return 41;
          if (mythicalD.has(e.dexId)) return 42;
          if (legendaryE.has(e.dexId)) return 43;
          if (mythicalE.has(e.dexId)) return 44;
          if (ultraBeast.has(e.dexId)) return 45;
          if (legendaryF.has(e.dexId)) return 46;
          if (mythicalF.has(e.dexId)) return 47;
          if (legendaryG.has(e.dexId)) return 48;
          if (noblePokemon.has(e.dexId)) return 49;
          if (noblePokemonA.has(e.dexId)) return 50;
          if (noblePokemonB.has(e.dexId)) return 51;
          if (noblePokemonC.has(e.dexId)) return 52;
          if (ridePokemon.has(e.dexId)) return 53;
          if (ridePokemonA.has(e.dexId)) return 54;
          if (ridePokemonB.has(e.dexId)) return 55;
          if (ridePokemonC.has(e.dexId)) return 56;
          if (mythicalG.has(e.dexId)) return 57;
          if (legendaryH.has(e.dexId)) return 58;
          if (pastParadox.has(e.dexId)) return 59;
          if (futureParadox.has(e.dexId)) return 60;
          if (legendaryI.has(e.dexId)) return 61;
          if (mythicalI.has(e.dexId)) return 62;
          if (megasXY.has(e.dexId)) return 63;
          if (megasXYA.has(e.dexId)) return 64;
          if (megasXYB.has(e.dexId)) return 65;
          if (megaORAS.has(e.dexId)) return 66;
          if (megaORASA.has(e.dexId)) return 67;
          if (megaORASB.has(e.dexId)) return 68;
          if (alolan.has(e.dexId)) return 69;
          if (alolanA.has(e.dexId)) return 70;
          if (alolanB.has(e.dexId)) return 71;
          if (alolanC.has(e.dexId)) return 72;
          if (galarian.has(e.dexId)) return 73;
          if (galarianA.has(e.dexId)) return 74;
          if (galarianB.has(e.dexId)) return 75;
          if (galarianC.has(e.dexId)) return 76;
          if (galarianD.has(e.dexId)) return 77;
          if (galarianE.has(e.dexId)) return 78;
          if (gMax.has(e.dexId)) return 79;
          if (gMaxA.has(e.dexId)) return 80;
          if (gMaxB.has(e.dexId)) return 81;
          if (gMaxC.has(e.dexId)) return 82;
          if (gMaxD.has(e.dexId)) return 83;
          if (hisuian.has(e.dexId)) return 84;
          if (hisuianA.has(e.dexId)) return 85;
          if (paldean.has(e.dexId)) return 86;
          if (paradoxInspire.has(e.dexId)) return 87;
          if (paradoxInspireA.has(e.dexId)) return 88;
          if (paradoxInspireB.has(e.dexId)) return 89;
          if (paradoxInspireC.has(e.dexId)) return 90;
          if (paradoxInspireD.has(e.dexId)) return 91;
          if (paradoxInspireE.has(e.dexId)) return 92;
          if (paradoxInspireF.has(e.dexId)) return 93;
          if (paradoxInspireG.has(e.dexId)) return 94;
          if (megasZA.has(e.dexId)) return 95;
          if (megasZAA.has(e.dexId)) return 96;
          if (megasZAB.has(e.dexId)) return 97;
          if (megasZAC.has(e.dexId)) return 98;
          if (megasMD.has(e.dexId)) return 99;
          if (megasMDA.has(e.dexId)) return 100;
          if (rocket.has(e.dexId)) return 101;
          if (rocketA.has(e.dexId)) return 102;
          if (rocketB.has(e.dexId)) return 103;
          if (rocketC.has(e.dexId)) return 104;
          if (magma.has(e.dexId)) return 105;
          if (aqua.has(e.dexId)) return 106;
          if (galactic.has(e.dexId)) return 107;
          if (galacticA.has(e.dexId)) return 108;
          if (plasma.has(e.dexId)) return 109;
          if (plasmaA.has(e.dexId)) return 110;
          if (plasmaB.has(e.dexId)) return 111;
          if (flare.has(e.dexId)) return 112;
          if (skull.has(e.dexId)) return 113;
          if (skullA.has(e.dexId)) return 114;
          if (rainbowRocket.has(e.exId)) return 115;
          if (rainbowRocketA.has(e.exId)) return 116;
          if (rainbowRocketB.has(e.exId)) return 117;
          if (yell.has(e.dexId)) return 118;
          if (star.has(e.dexId)) return 119;
          if (erikaRB.has(e.dexId)) return 120;
          if (giovanniRB.has(e.dexId)) return 121;
          if (giovanniRBA.has(e.dexId)) return 122;
          if (giovanniRBB.has(e.dexId)) return 123;
          if (loreleiRB.has(e.dexId)) return 124;
          if (loreleiRBA.has(e.dexId)) return 124;
          if (brunoRB.has(e.dexId)) return 125;
          if (brunoRBA.has(e.dexId)) return 126;
          if (whitneyGS.has(e.dexId)) return 127;
          if (chuckGS.has(e.dexId)) return 128;
          if (pryceGS.has(e.dexId)) return 129;
          if (clairGS.has(e.dexId)) return 130;
          if (mistyGS.has(e.dexId)) return 131;
          if (surgeGS.has(e.dexId)) return 132;
          if (surgeGSA.has(e.dexId)) return 133;
          if (erikaGS.has(e.dexId)) return 134;
          if (blaineGS.has(e.dexId)) return 135;
          if (blaineGSA.has(e.dexId)) return 136;
          if (blaineGSB.has(e.dexId)) return 137;
          if (willGS.has(e.dexId)) return 138;
          if (kogaGS.has(e.dexId)) return 139;
          if (roxanneRS.has(e.dexId)) return 140;
          if (flanneryRS.has(e.dexId)) return 141;
          if (normanRS.has(e.dexId)) return 142;
          if (tateLizaRS.has(e.dexId)) return 143;
          if (wallaceRS.has(e.dexId)) return 144;
          if (wallaceRSA.has(e.dexId)) return 145;
          if (sidneyRS.has(e.dexId)) return 146;
          if (sidneyRSA.has(e.dexId)) return 147;
          if (sidneyRSB.has(e.dexId)) return 148;
          if (phoebeRS.has(e.dexId)) return 149;
          if (drakeRS.has(e.dexId)) return 150;
          if (normanE.has(e.dexId)) return 151;
          if (juanE.has(e.dexId)) return 152;
          if (wallaceE.has(e.dexId)) return 153;
          return 999;
        };

        allEntries.sort((a, b) => {
          const ga = groupRank(a);
          const gb = groupRank(b);
          if (ga !== gb) return ga - gb;
          return baseSort(a, b);
        });
        return;
      }

      if (orderingMode === "families") {
        // Custom-ordered families first (exact order from ORDERED_FAMILIES_GROUPS),
        // then continue through the rest of the National Dex grouped by evolution chains.
        const baseSort = (a, b) => {
          if (a.dexId !== b.dexId) return a.dexId - b.dexId;
          if (!!a.isForm !== !!b.isForm) return a.isForm ? 1 : -1;
          return 0;
        };

        const normalizeSlug = (s) =>
          String(s || "")
            .trim()
            .toLowerCase()
            .replace(/[‚Äô']/g, "")
            .replace(/\./g, "")
            .replace(/\s+/g, "-");

        // Map normalized base species name -> dexId (so we can turn your list into dex positions)
        const baseDexByName = {};
        for (const e of allEntries) {
          if (e && !e.isForm && e.pokemonName) {
            baseDexByName[normalizeSlug(e.pokemonName)] = e.dexId;
          }
        }

        // Build dexId -> { groupIndex, withinGroupPos } for every dexId in ORDERED_FAMILIES_GROUPS
        const customDexPos = {}; // dexId -> { gi, pi }
        let gi = 0;
        for (const group of ORDERED_FAMILIES_GROUPS) {
          if (!Array.isArray(group)) continue;
          let pi = 0;
          for (const rawName of group) {
            const name = normalizeSlug(rawName);
            const dexId = baseDexByName[name];
            if (dexId != null && customDexPos[dexId] == null) {
              customDexPos[dexId] = { gi, pi };
              pi++;
            } else if (dexId == null) {
              console.warn("Ordered Families: species not found in dex data:", rawName);
            }
          }
          gi++;
        }

        // For non-custom dexIds, group by evolution chain id (via Pok√©API),
        // then sort those chains by their minimum dexId (National Dex order).
        const dexIds = Array.from(new Set(allEntries.map(e => e.dexId)));

        const chainIdByDex = {};
        const chainMinDex = {};

        async function fetchChainId(dexId) {
          try {
            const res = await fetch("https://pokeapi.co/api/v2/pokemon-species/" + dexId + "/");
            if (!res.ok) throw new Error("HTTP " + res.status);
            const data = await res.json();
            const url = data?.evolution_chain?.url || "";
            const m = url.match(/\/evolution-chain\/(\d+)\/?/);
            return m ? parseInt(m[1], 10) : null;
          } catch (err) {
            console.warn("Failed to fetch evolution chain for dexId", dexId, err);
            return null;
          }
        }

        // Only fetch chain ids for dex numbers that are NOT explicitly positioned by your custom list.
        for (const dexId of dexIds) {
          if (customDexPos[dexId] != null) continue;
          const chainId = await fetchChainId(dexId);
          chainIdByDex[dexId] = chainId == null ? dexId : chainId;
          chainMinDex[chainIdByDex[dexId]] = Math.min(
            chainMinDex[chainIdByDex[dexId]] ?? Infinity,
            dexId
          );
        }

        allEntries.sort((a, b) => {
          const ca = customDexPos[a.dexId];
          const cb = customDexPos[b.dexId];

          // Custom families always come first, in the exact group + within-group order you defined.
          if (ca && cb) {
            if (ca.gi !== cb.gi) return ca.gi - cb.gi;
            if (ca.pi !== cb.pi) return ca.pi - cb.pi;
            return baseSort(a, b);
          }
          if (ca && !cb) return -1;
          if (!ca && cb) return 1;

          // Everyone else: grouped by evolution chain, ordered by the chain's min dexId.
          const ga = chainIdByDex[a.dexId] ?? a.dexId;
          const gb = chainIdByDex[b.dexId] ?? b.dexId;
          const ma = chainMinDex[ga] ?? a.dexId;
          const mb = chainMinDex[gb] ?? b.dexId;
          if (ma !== mb) return ma - mb;
          if (ga !== gb) return ga - gb;
          return baseSort(a, b);
        });
        return;
      }

      allEntries.sort(baseSort);
    }
function startSorting() {
      if (allEntries.length < 2) return;
      ranking = [];
      currentInsertIndex = null;
      compareRankPos = null;
      mode = "initial";
      logBox.innerHTML = "";
      log("Sorting started. First: Bulbasaur vs Ivysaur.");
      statusMain.textContent = "Round 1: Pick between Bulbasaur and Ivysaur.";
      startBtn.textContent = "Restart";

      compareTitle.textContent = "Which do you like more to start?";
      setCardContent("left", 0);
      setCardContent("right", 1);
      updateButtonsEnabled(true);
      updateRankingUI();
      saveState();
    }

    function startInsertionForCurrent() {
      if (currentInsertIndex === null || currentInsertIndex >= allEntries.length) {
        finishSorting();
        return;
      }

      mode = "inserting";
      compareRankPos = ranking.length - 1;
      updateInsertionStatusTexts();
      showCurrentComparison();
      saveState();
    }

    function showCurrentComparison() {
      if (mode === "initial") {
        updateButtonsEnabled(true);
        return;
      }
      if (mode !== "inserting") return;

      if (compareRankPos === null || compareRankPos < 0 || ranking.length === 0) {
        insertCurrentAtTop();
        return;
      }

      const currentEntryIndex = currentInsertIndex;

      compareRankPos = getGroupStartPos(compareRankPos);
      const opponentEntryIndex = ranking[compareRankPos];

      const challenger = allEntries[currentEntryIndex];
      const opponent = allEntries[opponentEntryIndex];

      compareTitle.textContent = "Who do you like more right now?";

      setCardContent("left", currentEntryIndex);
      setCardContent("right", opponentEntryIndex);

      log(
        "Comparing " +
          fullDisplayName(challenger) +
          " (No." +
          challenger.dexId +
          ") vs " +
          fullDisplayName(opponent) +
          " (No." +
          opponent.dexId +
          ")."
      );

      updateButtonsEnabled(true);
    }

    function insertCurrentAtTop() {
      ranking.unshift(currentInsertIndex);
      const entry = allEntries[currentInsertIndex];
      log(
        fullDisplayName(entry) +
          " (No." +
          entry.dexId +
          ") beat everyone and is now your new #1."
      );
      updateRankingUI();
      moveToNextInsert();
    }

    function insertCurrentAfterOpponentAt(pos) {
      const safePos = Math.max(0, Math.min(pos, ranking.length - 1));
      const opponentIndex = ranking[safePos];
      ranking.splice(safePos + 1, 0, currentInsertIndex);

      const entry = allEntries[currentInsertIndex];
      const opp = allEntries[opponentIndex];

      log(
        fullDisplayName(entry) +
          " (No." +
          entry.dexId +
          ") placed just below " +
          fullDisplayName(opp) +
          " (No." +
          opp.dexId +
          ")."
      );
      updateRankingUI();
      moveToNextInsert();
    }

    function moveToNextInsert() {
      currentInsertIndex++;
      if (currentInsertIndex >= allEntries.length) {
        finishSorting();
      } else {
        startInsertionForCurrent();
      }
      saveState();
    }

    function finishSorting() {
      mode = "done";
      updateButtonsEnabled(false);
      tieBtn.disabled = true;
      undoBtn.disabled = actionHistory.length === 0;
      statusMain.textContent = "You‚Äôve ranked the entire Pok√©dex!";
      compareTitle.textContent = "üéâ Sorting complete. Scroll to bottom for your full ranking in a grid. üéâ";
      log("All entries processed. You now have a full personal ranking.");
      saveState();
    }

    function handleChoice(side) {
      if (mode === "idle") return;

      // Record state so Undo can rewind spamming/mistakes.
      pushHistorySnapshot();

      if (mode === "initial") {
        let first, second;
        if (side === "left") {
          first = 0;
          second = 1;
          log("You prefer Bulbasaur over Ivysaur. #1 Bulbasaur, #2 Ivysaur.");
        } else {
          first = 1;
          second = 0;
          log("You prefer Ivysaur over Bulbasaur. #1 Ivysaur, #2 Bulbasaur.");
        }
        ranking = [first, second];
        updateRankingUI();

        currentInsertIndex = 2;
        startInsertionForCurrent();
        saveState();
        return;
      }

      if (mode !== "inserting") return;
      if (currentInsertIndex === null) return;

      const currentIdx = currentInsertIndex;

      // Always compare vs the TOP of a tie-block (if any).
      const oppPosStart = getGroupStartPos(compareRankPos);
      const oppPosEnd = getGroupEndPos(oppPosStart);
      compareRankPos = oppPosStart;

      const oppIdx = ranking[oppPosStart];

      const currentEntry = allEntries[currentIdx];
      const oppEntry = allEntries[oppIdx];

      if (side === "left") {
        log(
          "You chose " +
            fullDisplayName(currentEntry) +
            " over " +
            fullDisplayName(oppEntry) +
            "."
        );

        if (oppPosStart === 0) {
          insertCurrentAtTop();
        } else {
          // Move upward past the whole tie-block.
          compareRankPos = oppPosStart - 1;
          compareRankPos = getGroupStartPos(compareRankPos);
          showCurrentComparison();
          saveState();
        }
      } else {
        log(
          "You chose " +
            fullDisplayName(oppEntry) +
            " over " +
            fullDisplayName(currentEntry) +
            "."
        );
        insertCurrentAfterOpponentAt(oppPosEnd);
      }
    }

    function handleTie() {
      if (mode === "idle") return;

      // Record state so Undo can rewind spamming/mistakes.
      pushHistorySnapshot();

      if (mode === "initial") {
        ranking = [0, 1];
        ensureGroupForEntries(0, 1);
        log("You tied Bulbasaur and Ivysaur. They will share the same rank.");
        updateRankingUI();

        currentInsertIndex = 2;
        startInsertionForCurrent();
        saveState();
        return;
      }

      if (mode !== "inserting") return;
      if (currentInsertIndex === null) return;

      const currentIdx = currentInsertIndex;

      const oppPosStart = getGroupStartPos(compareRankPos);
      const oppPosEnd = getGroupEndPos(oppPosStart);
      compareRankPos = oppPosStart;

      const oppIdx = ranking[oppPosStart];

      ensureGroupForEntries(currentIdx, oppIdx);

      ranking.splice(oppPosEnd + 1, 0, currentIdx);

      const entry = allEntries[currentIdx];
      const opp = allEntries[oppIdx];

      log(
        fullDisplayName(entry) +
          " (No." +
          entry.dexId +
          ") tied with " +
          fullDisplayName(opp) +
          " (No." +
          opp.dexId +
          ")."
      );

      updateRankingUI();
      moveToNextInsert();
    }

    function resetSorting() {
      ranking = [];
      currentInsertIndex = null;
      compareRankPos = null;
      mode = "idle";
      tieGroupByEntry = {};
      nextTieGroupId = 1;
      actionHistory = [];
      updateRankingUI();
      compareTitle.textContent = "Waiting to start‚Ä¶";
      nameLeft.textContent = "‚Äî";
      idLeft.textContent = "";
      imgLeft.style.display = "none";
      imgPlaceholderLeft.style.display = "block";
      imgPlaceholderLeft.textContent = "No image";

      nameRight.textContent = "‚Äî";
      idRight.textContent = "";
      imgRight.style.display = "none";
      imgPlaceholderRight.style.display = "block";
      imgPlaceholderRight.textContent = "No image";

      statusMain.textContent =
        "Pok√©dex loaded: " + allEntries.length + " entries (species + forms).";
      logBox.innerHTML = "";
      log("Sorting reset. Press Start when you‚Äôre ready again.");
      updateButtonsEnabled(false);
      tieBtn.disabled = true;
      undoBtn.disabled = actionHistory.length === 0;
      startBtn.textContent = "Start!";
      clearState();
    }

    async function restoreStateIfExists() {
      let raw;
      try {
        raw = localStorage.getItem(STORAGE_KEY);
      } catch (err) {
        console.error("Error reading storage:", err);
        return;
      }
         if (!raw) {
          updateRankingUI();
          if (allEntries.length >= 2) {
            askUnownMode();
            askCastformMode();
            askDeoxysMode();
            askBurmyMode();
            askWormadamMode();
            askRotomMode();
            askArceusMode();
            askDeerlingSawsbuckMode();
            askGenesectMode();
            askVivillonMode();
            askFlabebeFloetteFlorgesMode();
            askFurFrouMode();
            askPumpkabooGourgeistMode();
            askLycanrocMode();
            askSilvallyMode();
            askMiniorMode();
            askAlcremieMode();
            askSquawkabillyMode();
            askMegasMode();
            askGMaxMode();
            askOrderingMode();
            rebuildAllEntriesFromBase();
            await applyOrderingMode();
            resetSorting();
            startSorting();
          }
          return;
        }


      let data;
      try {
        data = JSON.parse(raw);
      } catch (err) {
        console.error("Error parsing stored state:", err);
        return;
      }

      if (!data || !Array.isArray(data.ranking)) {
        updateRankingUI();
        return;
      }

      ranking = data.ranking.filter(
        (i) => typeof i === "number" && i >= 0 && i < allEntries.length
      );
      currentInsertIndex =
        typeof data.currentInsertIndex === "number"
          ? data.currentInsertIndex
          : null;
      compareRankPos =
        typeof data.compareRankPos === "number"
          ? data.compareRankPos
          : null;
      mode = data.mode || "idle";

      tieGroupByEntry = data.tieGroupByEntry && typeof data.tieGroupByEntry === "object" ? data.tieGroupByEntry : {};
      nextTieGroupId = typeof data.nextTieGroupId === "number" ? data.nextTieGroupId : 1;
      actionHistory = Array.isArray(data.actionHistory) ? data.actionHistory : [];

      updateRankingUI();
      logBox.innerHTML = "";
      startBtn.textContent = "Restart";

      if (mode === "idle") {
        statusMain.textContent =
          "Pok√©dex loaded: " + allEntries.length + " entries (species + forms).";
        updateButtonsEnabled(false);
        tieBtn.disabled = true;
      undoBtn.disabled = actionHistory.length === 0;
        log("No active session. Press Start to begin.");
        return;
      }

      if (mode === "done") {
        statusMain.textContent =
          "Previous session finished. You can reset to start over.";
        compareTitle.textContent = "Sorting complete üéâ";
        updateButtonsEnabled(false);
        tieBtn.disabled = true;
      undoBtn.disabled = actionHistory.length === 0;
        log("Restored finished ranking from previous session.");
        return;
      }

      if (mode === "initial") {
        statusMain.textContent =
          "Round 1: Pick between Bulbasaur and Ivysaur (resumed).";
        compareTitle.textContent = "Which do you like more to start?";
        setCardContent("left", 0);
        setCardContent("right", 1);
        updateButtonsEnabled(true);
        tieBtn.disabled = true;
      undoBtn.disabled = actionHistory.length === 0;
        log("Restored session at the very first comparison.");
        return;
      }

      if (mode === "inserting") {
        if (
          currentInsertIndex === null ||
          currentInsertIndex >= allEntries.length
        ) {
          finishSorting();
          return;
        }
        if (
          compareRankPos === null ||
          compareRankPos < 0 ||
          compareRankPos >= ranking.length
        ) {
          compareRankPos = ranking.length - 1;
        }

        updateInsertionStatusTexts();
        compareTitle.textContent = "Who do you like more right now?";
        showCurrentComparison();
        updateButtonsEnabled(true);
        tieBtn.disabled = false;
        undoBtn.disabled = actionHistory.length === 0;
        log("Restored session mid-insertion. Continue making choices.");
        return;
      }
    }
    // --- EVENTS ---

    musicBtn.addEventListener("click", () => {
        console.log("Music button clicked");
        toggleMusic();
    });


    startBtn.addEventListener("click", async () => {
      askUnownMode();
      askCastformMode();
      askDeoxysMode();
      askBurmyMode();
      askWormadamMode();
      askRotomMode();
      askArceusMode();
      askDeerlingSawsbuckMode();
      askGenesectMode();
      askVivillonMode();
      askFlabebeFloetteFlorgesMode();
      askFurFrouMode();
      askPumpkabooGourgeistMode();
      askLycanrocMode();
      askSilvallyMode();
      askMiniorMode();
      askAlcremieMode();
      askSquawkabillyMode();
      askMegasMode();
      askGMaxMode();
      askOrderingMode();
      rebuildAllEntriesFromBase();
      await applyOrderingMode();
      resetSorting();
      startSorting();
    });

    btnLeft.addEventListener("click", () => {
      updateButtonsEnabled(false);
      handleChoice("left");
    });

    btnRight.addEventListener("click", () => {
      updateButtonsEnabled(false);
      handleChoice("right");
    });

    tieBtn.addEventListener("click", () => {
      updateButtonsEnabled(false);
      handleTie();
    });

    undoBtn.addEventListener("click", () => {
      undoLastAction();
    });

    resetBtn.addEventListener("click", () => {
      resetSorting();
      askUnownMode();
      askCastformMode();
      askDeoxysMode();
      askBurmyMode();
      askWormadamMode();
      askRotomMode();
      askArceusMode();
      askDeerlingSawsbuckMode();
      askGenesectMode();
      askVivillonMode();
      askFlabebeFloetteFlorgesMode();
      askFurFrouMode();
      askPumpkabooGourgeistMode();
      askLycanrocMode();
      askSilvallyMode();
      askMiniorMode();
      askAlcremieMode();
      askSquawkabillyMode();
      askMegasMode();
      askGMaxMode();
      askOrderingMode();
      startSorting();
    });

    // --- INIT ---
    fetchSpeciesListAndBuildEntries();
  </script>
</body>
</html>


